<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Diagn√≥stico M√©dico Avan√ßado com IA</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/particles.js@2.0.0/particles.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/dsp.js/1.0.0/dsp.min.js" onerror="console.warn('dsp.js failed to load, falling back to simulated heart rate')"></script>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap">
    <style>
        html { scroll-behavior: smooth; }
        body {
            position: relative;
            overflow-x: hidden;
            font-family: 'Inter', sans-serif;
            background: transparent;
        }
        #particles-js {
            position: absolute;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
            z-index: -1;
            background: linear-gradient(135deg, #0b1120, #1e1b4b, #2e1065);
        }
        .fade-in { animation: fadeIn 1s ease-in-out; }
        .slide-in-left { animation: slideInLeft 1.2s ease-in-out; }
        .slide-in-right { animation: slideInRight 1.2s ease-in-out; }
        .pulse { animation: pulse 2s infinite ease-in-out; }
        .shine { position: relative; overflow: hidden; }
        .shine::after {
            content: ''; position: absolute; top: -50%; left: -50%; width: 200%; height: 200%;
            background: linear-gradient(45deg, rgba(255, 255, 255, 0), rgba(255, 255, 255, 0.3), rgba(255, 255, 255, 0));
            transform: rotate(20deg); animation: shine 4s infinite linear;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        @keyframes slideInLeft {
            from { opacity: 0; transform: translateX(-50px); }
            to { opacity: 1; transform: translateX(0); }
        }
        @keyframes slideInRight {
            from { opacity: 0; transform: translateX(50px); }
            to { opacity: 1; transform: translateX(0); }
        }
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.03); }
            100% { transform: scale(1); }
        }
        @keyframes shine {
            0% { transform: translateX(-100%) rotate(45deg); }
            100% { transform: translateX(100%) rotate(45deg); }
        }
        .holo-nav {
            background: rgba(17, 24, 39, 0.85);
            backdrop-filter: blur(10px);
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            animation: holoGlow 2s infinite alternate;
        }
        @keyframes holoGlow {
            0% { box-shadow: 0 0 8px #22d3ee; }
            100% { box-shadow: 0 0 15px #22d3ee; }
        }
        .holo-nav a, .holo-nav button {
            transition: color 0.3s ease;
        }
        .holo-nav a:hover, .holo-nav button:hover {
            color: #22d3ee;
            text-shadow: 0 0 5px #22d3ee;
        }
        .futuristic-btn {
            background: linear-gradient(45deg, #7C3AED, #22d3ee);
            box-shadow: 0 0 8px #22d3ee;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            animation: neonPulse 1.5s infinite alternate;
        }
        .futuristic-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 0 20px #22d3ee, 0 0 30px #22d3ee;
        }
        @keyframes neonPulse {
            0% { box-shadow: 0 0 5px #22d3ee; }
            100% { box-shadow: 0 0 15px #22d3ee; }
        }
        #chat-container {
            position: fixed;
            bottom: 20px;
            right: 20px;
            z-index: 1000;
        }
        #chat-bubble {
            background: linear-gradient(45deg, #7C3AED, #22d3ee);
            border-radius: 50%;
            width: 60px;
            height: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            box-shadow: 0 0 15px #22d3ee;
            animation: pulse 2s infinite;
        }
        #chat-window {
            display: none;
            background: rgba(17, 24, 39, 0.95);
            backdrop-filter: blur(10px);
            border: 1px solid #22d3ee;
            border-radius: 15px;
            width: 320px;
            height: 420px;
            position: absolute;
            bottom: 80px;
            right: 0;
            box-shadow: 0 0 15px #22d3ee;
        }
        #chat-messages {
            height: 340px;
            overflow-y: auto;
            padding: 12px;
            color: #e5e7eb;
        }
        #chat-input {
            background: rgba(55, 65, 81, 0.8);
            border: 1px solid #22d3ee;
            border-radius: 20px;
            padding: 10px;
            width: 100%;
            color: white;
        }
        .listening-indicator {
            display: none;
            color: #22d3ee;
            font-size: 0.9rem;
            text-align: center;
            margin-top: 5px;
        }
        .listening-indicator.active { display: block; }
        .animate-on-scroll {
            opacity: 0;
            transform: translateY(40px);
            transition: opacity 0.8s ease-out, transform 0.8s ease-out;
        }
        .animate-on-scroll.visible {
            opacity: 1;
            transform: translateY(0);
        }
        .form-input, .form-textarea {
            background: rgba(55, 65, 81, 0.8);
            border: 1px solid #22d3ee;
            border-radius: 8px;
            padding: 12px;
            color: white;
            width: 100%;
            transition: border-color 0.3s, box-shadow 0.3s;
        }
        .form-input:focus, .form-textarea:focus {
            outline: none;
            border-color: #22d3ee;
            box-shadow: 0 0 8px #22d3ee;
        }
        .screen {
            display: none;
            opacity: 0;
            transition: opacity 0.5s ease;
        }
        .screen.active {
            display: block;
            opacity: 1;
        }
        @media (max-width: 768px) {
            .holo-nav .header-right { flex-direction: column; align-items: flex-end; }
            h1 { font-size: 2.25rem; line-height: 2.5rem; }
            h2 { font-size: 1.5rem; }
            .max-w-3xl { max-width: 100%; padding: 0 1rem; }
            .grid { grid-template-columns: 1fr; }
            .futuristic-btn { width: 100%; margin-bottom: 0.5rem; }
            #chat-window { width: 95%; right: 2.5%; }
        }
        @media (max-width: 480px) {
            #avaliacao-emocional { py-10 px-4; }
            .neon-box { padding: 1rem; max-height: 70vh; overflow-y: auto; }
            .form-group { margin-bottom: 0.5rem; }
            .flex { flex-direction: column; gap: 0.5rem; }
            .checkbox-grid { grid-template-columns: 1fr; }
            h2 { font-size: 1.25rem; }
            label, .instructions { font-size: 0.875rem; }
            #mobile-menu a { font-size: 1rem; }
            #chat-window { width: 90%; right: 5%; height: 350px; }
            #chat-messages { height: 270px; }
        }
    </style>
</head>
<body class="text-white">
  <!-- Fundo com Part√≠culas -->
  <div id="particles-js"></div>

  <!-- Cabe√ßalho com Efeito Hologr√°fico -->
  <header class="holo-nav fixed top-0 left-0 w-full z-50 transition-shadow duration-300">
    <div class="max-w-7xl mx-auto px-6 py-4 flex justify-between items-center">
      <div class="flex items-center space-x-3">
        <a href="/index.html" aria-label="P√°gina inicial da √Ålibis Digital">
          <img src="/assets/logo.png" alt="Logo da √Ålibis Digital" class="h-10 w-auto">
        </a>
      </div>
      <div class="flex items-center space-x-3">
        <div class="md:hidden">
          <button id="hamburger-menu" class="text-white focus:outline-none p-2 rounded" aria-label="Abrir menu de navega√ß√£o">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />
            </svg>
          </button>
        </div>
      </div>
      <nav id="navbar" class="hidden md:flex space-x-4 text-sm items-center">
        <a href="/blog.html" class="hover:text-[#22d3ee] transition">Blog</a>
        <a href="/alibi.html" class="hover:text-[#22d3ee] transition">Criar √Ålibi</a>
        <a href="/scanner.html" class="hover:text-[#22d3ee] transition">Scanner com IA</a>
        <a href="/apoio-emocional.html" class="hover:text-[#22d3ee] transition">Apoio Emocional</a>
        <a href="/suporte.html" class="hover:text-[#22d3ee] transition">Suporte</a>
        <a href="/login.html" class="futuristic-btn text-white py-2 px-4 rounded-full text-sm font-semibold" aria-label="Fazer login">Login</a>
        <a href="/criar-conta.html" class="futuristic-btn text-white py-2 px-4 rounded-full text-sm font-semibold bounce-in" aria-label="Criar conta">Criar Conta</a>
      </nav>
    </div>
    <div id="mobile-menu" class="md:hidden bg-[rgba(31,41,55,0.9)] w-full hidden py-4">
      <nav class="flex flex-col items-center space-y-4">
        <a href="/blog.html" class="text-white py-2 px-4 text-lg w-full text-center hover:bg-gray-700 rounded">Blog</a>
        <a href="/alibi.html" class="text-white py-2 px-4 text-lg w-full text-center hover:bg-gray-700 rounded">Criar √Ålibi</a>
        <a href="/scanner.html" class="text-white py-2 px-4 text-lg w-full text-center hover:bg-gray-700 rounded">Scanner com IA</a>
        <a href="/apoio-emocional.html" class="text-white py-2 px-4 text-lg w-full text-center hover:bg-gray-700 rounded">Apoio Emocional</a>
        <a href="/suporte.html" class="text-white py-2 px-4 text-lg w-full text-center hover:bg-gray-700 rounded">Suporte</a>
      </nav>
    </div>
  </header>
  <div class="h-20"></div>

  <section id="avaliacao-emocional" class="py-20 px-6">
    <div class="max-w-3xl mx-auto text-center">
      <h2 class="text-4xl font-bold mb-4 text-[#22d3ee] fade-in shine">Medical IA - Diagn√≥stico M√©dico Avan√ßado com IA</h2>
      <p class="text-white mb-4 text-center">Obtenha um pr√©-diagn√≥stico avan√ßado com tecnologia de ponta. Responda ao question√°rio abaixo.</p>
      <div class="neon-box mt-6 max-w-4xl mx-auto p-8 bg-gray-800 bg-opacity-80 backdrop-filter backdrop-blur-sm">
        <form id="diagnostico-form">
          <!-- Step 1: Dados Demogr√°ficos (First Set) -->
          <div id="step-1" class="step active">
            <div class="instructions text-white-400 mb-4">
              Forne√ßa suas informa√ß√µes b√°sicas para come√ßar. Esses dados ajudam a personalizar seu pr√©-diagn√≥stico.
            </div>
            <div class="form-group mb-4">
              <label class="required text-white" for="sexo">Sexo Biol√≥gico</label>
              <select id="sexo" required class="w-full p-2 bg-gray-800 border border-[#22d3ee] rounded">
                <option value="">Selecione...</option>
                <option value="Masculino">Masculino</option>
                <option value="Feminino">Feminino</option>
              </select>
              <div id="sexo-error" class="error-message text-red-500 mt-1 hidden">Por favor, selecione uma op√ß√£o.</div>
            </div>
            <div class="form-group mb-4">
              <label class="required text-white" for="idade">Idade (anos)</label>
              <input id="idade" type="number" min="0" max="120" placeholder="Ex.: 40" required class="w-full p-2 bg-gray-800 border border-[#22d3ee] rounded">
              <div id="idade-error" class="error-message text-red-500 mt-1 hidden">Por favor, informe sua idade.</div>
            </div>
            <div class="form-group mb-4">
              <label class="required text-white">Peso (kg) e Altura (m)</label>
              <div class="flex gap-4">
                <div class="flex-1">
                  <input id="peso" type="number" step="0.1" min="0" placeholder="Ex.: 70" required class="w-full p-2 bg-gray-800 border border-[#22d3ee] rounded">
                  <div id="peso-error" class="error-message text-red-500 mt-1 hidden">Por favor, informe seu peso.</div>
                </div>
                <div class="flex-1">
                  <input id="altura" type="number" step="0.01" min="0" placeholder="Ex.: 1.80" required class="w-full p-2 bg-gray-800 border border-[#22d3ee] rounded">
                  <div id="altura-error" class="error-message text-red-500 mt-1 hidden">Por favor, informe sua altura.</div>
                </div>
              </div>
            </div>
            <button id="next-set-1" type="button" class="futuristic-btn mt-4">Pr√≥ximo</button>
          </div>

          <!-- Step 2-3: Sintomas e Contexto (Second Set) -->
          <div id="step-2-3" class="step">
            <div class="instructions text-gray-400 mb-4">
              Selecione seus sintomas e forne√ßa o contexto. Responda √†s tr√™s pr√≥ximas perguntas.
            </div>
            <div class="form-group mb-4">
              <label class="required text-white">Sintomas Principais (Selecione at√© 5)</label>
              <div class="checkbox-grid grid grid-cols-2 gap-2">
                <label class="flex items-center"><input type="checkbox" name="sintomas" value="Febre/Hipertermia" class="mr-2"> Febre/Hipertermia</label>
                <label class="flex items-center"><input type="checkbox" name="sintomas" value="Tosse" class="mr-2"> Tosse</label>
                <label class="flex items-center"><input type="checkbox" name="sintomas" value="Dispneia" class="mr-2"> Dispneia (Falta de Ar)</label>
                <label class="flex items-center"><input type="checkbox" name="sintomas" value="Dor de Cabe√ßa" class="mr-2"> Dor de Cabe√ßa</label>
                <label class="flex items-center"><input type="checkbox" name="sintomas" value="Dor Muscular" class="mr-2"> Dor Muscular/Articular</label>
                <label class="flex items-center"><input type="checkbox" name="sintomas" value="Fadiga" class="mr-2"> Fadiga (Cansa√ßo Extremo)</label>
                <label class="flex items-center"><input type="checkbox" name="sintomas" value="N√°usea/V√¥mito" class="mr-2"> N√°usea/V√¥mito</label>
                <label class="flex items-center"><input type="checkbox" name="sintomas" value="Dor Abdominal" class="mr-2"> Dor Abdominal</label>
                <label class="flex items-center"><input type="checkbox" name="sintomas" value="Manchas Cut√¢neas" class="mr-2"> Manchas Cut√¢neas</label>
                <label class="flex items-center"><input type="checkbox" name="sintomas" value="Icter√≠cia" class="mr-2"> Icter√≠cia</label>
                <label class="flex items-center"><input type="checkbox" name="sintomas" value="Outro" class="mr-2"> Outro</label>
              </div>
              <div id="sintomas-error" class="error-message text-red-500 mt-1 hidden">Por favor, selecione pelo menos um sintoma.</div>
              <input id="sintomas-outra" type="text" class="w-full p-2 bg-gray-800 border border-[#22d3ee] rounded mt-2 hidden" placeholder="Especifique o sintoma">
            </div>
            <div class="form-group mb-4 hidden" id="febre-details">
              <label class="text-white" for="temperatura">Temperatura M√°xima (¬∞C)</label>
              <input id="temperatura" type="number" step="0.1" min="35" max="42" placeholder="Ex.: 38.5" class="w-full p-2 bg-gray-800 border border-[#22d3ee] rounded">
            </div>
            <div class="form-group mb-4 hidden" id="dor-details">
              <label class="text-white" for="dor-intensidade">Intensidade da Dor (0-10)</label>
              <input id="dor-intensidade" type="number" min="0" max="10" placeholder="Ex.: 7" class="w-full p-2 bg-gray-800 border border-[#22d3ee] rounded">
            </div>
            <div class="form-group mb-4 hidden" id="tosse-details">
              <label class="text-white" for="tosse-tipo">Tipo de Tosse</label>
              <select id="tosse-tipo" class="w-full p-2 bg-gray-800 border border-[#22d3ee] rounded">
                <option value="">Selecione...</option>
                <option value="Seca">Seca</option>
                <option value="Produtiva">Produtiva (com secre√ß√£o)</option>
              </select>
            </div>
            <div class="form-group mb-4 hidden" id="dispneia-details">
              <label class="text-white" for="dispneia-gravidade">Gravidade da Dispneia (0-4)</label>
              <select id="dispneia-gravidade" class="w-full p-2 bg-gray-800 border border-[#22d3ee] rounded">
                <option value="0">0: Sem falta de ar</option>
                <option value="1">1: Leve, s√≥ em esfor√ßos intensos</option>
                <option value="2">2: Moderada, ao caminhar r√°pido</option>
                <option value="3">3: Grave, ao caminhar devagar</option>
                <option value="4">4: Muito grave, em repouso</option>
              </select>
            </div>
            <div class="form-group mb-4">
              <label class="required text-white" for="duracao">Dura√ß√£o dos Sintomas</label>
              <select id="duracao" required class="w-full p-2 bg-gray-800 border border-[#22d3ee] rounded">
                <option value="">Selecione...</option>
                <option value="Horas">Horas</option>
                <option value="1-3 Dias">1-3 Dias</option>
                <option value="4-7 Dias">4-7 Dias</option>
                <option value="8-14 Dias">8-14 Dias</option>
                <option value="Mais de 14 Dias">Mais de 14 Dias</option>
                <option value="Cr√¥nico">Cr√¥nico (>3 meses)</option>
              </select>
              <div id="duracao-error" class="error-message text-red-500 mt-1 hidden">Por favor, selecione a dura√ß√£o.</div>
            </div>
            <div class="form-group mb-4">
              <label class="text-white" for="desencadeantes">Fatores Desencadeantes ou Agravantes</label>
              <input id="desencadeantes" type="text" placeholder="Ex.: frio, esfor√ßo f√≠sico" class="w-full p-2 bg-gray-800 border border-[#22d3ee] rounded">
            </div>
            <button id="next-set-2" type="button" class="futuristic-btn mt-4">Pr√≥ximo</button>
          </div>

          <!-- Step 4-6: Doen√ßas, Estilo de Vida e Revis√£o (Third Set) -->
          <div id="step-4-6" class="step">
            <div class="instructions text-gray-400 mb-4">
              Informe condi√ß√µes cr√¥nicas, estilo de vida e sintomas adicionais.
            </div>
            <div class="form-group mb-4">
              <label class="text-white">Doen√ßas Cr√¥nicas</label>
              <div class="checkbox-grid grid grid-cols-2 gap-2">
                <label class="flex items-center"><input type="checkbox" name="cronicas" value="Nenhuma" class="mr-2"> Nenhuma</label>
                <label class="flex items-center"><input type="checkbox" name="cronicas" value="Diabetes" class="mr-2"> Diabetes</label>
                <label class="flex items-center"><input type="checkbox" name="cronicas" value="Hipertens√£o" class="mr-2"> Hipertens√£o</label>
                <label class="flex items-center"><input type="checkbox" name="cronicas" value="Asma" class="mr-2"> Asma</label>
                <label class="flex items-center"><input type="checkbox" name="cronicas" value="Doen√ßa do Cora√ß√£o" class="mr-2"> Doen√ßa do Cora√ß√£o</label>
                <label class="flex items-center"><input type="checkbox" name="cronicas" value="Depress√£o" class="mr-2"> Depress√£o</label>
                <label class="flex items-center"><input type="checkbox" name="cronicas" value="Enxaqueca" class="mr-2"> Enxaqueca</label>
                <label class="flex items-center"><input type="checkbox" name="cronicas" value="Outra" class="mr-2"> Outra</label>
              </div>
              <input id="cronicas-outra" type="text" class="w-full p-2 bg-gray-800 border border-[#22d3ee] rounded mt-2 hidden" placeholder="Especifique (ex.: artrite)">
            </div>
            <div class="form-group mb-4">
              <label class="required text-white" for="tabagismo">Tabagismo</label>
              <select id="tabagismo" required class="w-full p-2 bg-gray-800 border border-[#22d3ee] rounded">
                <option value="Nunca Fumou">Nunca Fumou</option>
                <option value="Ex-Fumante">Ex-Fumante</option>
                <option value="Fumante Ativo">Fumante Ativo</option>
              </select>
              <div id="tabagismo-error" class="error-message text-red-500 mt-1 hidden">Por favor, selecione uma op√ß√£o.</div>
              <input id="tabagismo-detalhes" type="text" class="w-full p-2 bg-gray-800 border border-[#22d3ee] rounded mt-2 hidden" placeholder="Ex.: 20 ma√ßos-ano">
            </div>
            <div class="form-group mb-4">
              <label class="text-white" for="observacoes">Observa√ß√µes Adicionais</label>
              <textarea id="observacoes" rows="3" placeholder="Descreva outros sintomas ou informa√ß√µes relevantes" class="w-full p-2 bg-gray-800 border border-[#22d3ee] rounded"></textarea>
            </div>
            <button id="submit-form" type="submit" class="futuristic-btn mt-4" disabled>Obter Diagn√≥stico</button>
          </div>

          <div id="resultado-diagnostico" class="result-container hidden mt-6">
            <h2 class="text-2xl font-bold text-[#22d3ee] mb-4">ü©∫ Pr√©-Diagn√≥stico Cl√≠nico</h2>
            <div id="resposta-diagnostico"></div>
            <p class="text-gray-400 mt-4">‚ö†Ô∏è Este √© um pr√©-diagn√≥stico gerado por IA. N√£o substitui uma consulta m√©dica profissional. Consulte um m√©dico para um diagn√≥stico preciso.</p>
          </div>
        </form>
      </div>
    </div>
  </section>

  <!-- Rodap√© -->
  <footer class="bg-[rgba(15,23,42,0.8)] py-12 px-4 text-white">
    <div class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
        <div class="space-y-4">
          <h3 class="text-xl font-bold text-white shine">√Ålibi Digital</h3>
          <p class="text-sm text-gray-400 fade-in">Solu√ß√µes de bem-estar com tecnologia avan√ßada.</p>
        </div>
        <div class="space-y-4">
          <h4 class="text-lg font-semibold text-white">Navegue</h4>
          <ul class="space-y-2 text-sm">
            <li><a href="/" class="hover:text-white transition">In√≠cio</a></li>
            <li><a href="/scanner.html" class="hover:text-white transition">Scanner</a></li>
            <li><a href="/blog.html" class="hover:text-white transition">Blog</a></li>
            <li><a href="/medical-ia.html" class="hover:text-white transition">Diagn√≥stico M√©dico</a></li>
            <li><a href="/apoio-emocional.html" class="hover:text-white transition">Apoio Emocional</a></li>
            <li><a href="/alibi.html" class="hover:text-white transition">Criar √Ålibi</a></li>
            <li><a href="/planos.html" class="hover:text-white transition">Planos</a></li>
            <li><a href="/suporte.html" class="hover:text-white transition">Suporte</a></li>
            <li><a href="/criar-conta.html" class="hover:text-white transition">Criar Conta</a></li>
            <li><a href="/login.html" class="hover:text-white transition">Login</a></li>
          </ul>
        </div>
        <div class="space-y-4">
          <h4 class="text-lg font-semibold text-white">Contato</h4>
          <ul class="space-y-2 text-sm">
            <li class="fade-in">E-mail: <a href="mailto:support@alibisdigital.com.br" class="hover:text-white transition">support@alibisdigital.com.br</a></li>
            <li class="fade-in">WhatsApp: <a href="https://wa.me/5511912345678" class="hover:text-white transition">(11) 91234-5678</a></li>
            <li><a href="/privacidade.html" class="hover:text-white transition">Pol√≠tica de Privacidade</a></li>
            <li><a href="/termos.html" class="hover:text-white transition">Termos de Uso</a></li>
            <li><a href="/politicas.html" class="hover:text-white transition">Pol√≠ticas Gerais</a></li>
          </ul>
        </div>
      </div>
      <div class="mt-8 text-center">
        <p class="text-xs text-gray-500">¬© 2025 √Ålibis Digital. Todos os direitos reservados.</p>
      </div>
    </div>
  </footer>

  <script>
    document.addEventListener('DOMContentLoaded', () => {
      console.log('[INIT] DOM loaded, initializing form');

      let currentSet = 1;
      const steps = document.querySelectorAll('.step');
      const submitButton = document.getElementById('submit-form');
      const form = document.getElementById('diagnostico-form');
      const nextSet1 = document.getElementById('next-set-1');
      const nextSet2 = document.getElementById('next-set-2');

      if (!steps.length) console.error('[ERROR] No .step elements found');
      if (!submitButton) console.error('[ERROR] Submit button missing');

      // Inicializar part√≠culas
      particlesJS('particles-js', {
        particles: {
          number: { value: 80, density: { enable: true, value_area: 800 } },
          color: { value: '#22d3ee' },
          shape: { type: 'circle' },
          opacity: { value: 0.5, random: true },
          size: { value: 3, random: true },
          move: { enable: true, speed: 2, direction: 'none', random: true }
        },
        interactivity: {
          events: { onhover: { enable: true, mode: 'repulse' } }
        }
      });

      function updateSet() {
        console.log(`[NAV] Updating to set ${currentSet}`);
        steps.forEach((step, index) => {
          const isActive = (index === currentSet - 1);
          step.classList.toggle('active', isActive);
          console.log(`[NAV] Step ${index + 1} active: ${isActive}`);
        });
        validateSet();
      }

      function validateSet() {
        console.log(`[VALIDATE] Validating set ${currentSet}`);
        let valid = true;
        const currentStep = steps[currentSet - 1];
        if (!currentStep) {
          console.error(`[ERROR] Step ${currentSet} element not found`);
          return false;
        }

        const requiredInputs = currentStep.querySelectorAll('input[required], select[required]');
        requiredInputs.forEach(input => {
          const errorElement = document.getElementById(`${input.id}-error`);
          const isValid = input.value && input.value !== '';
          if (!isValid) {
            valid = false;
            input.classList.add('border-red-500');
            if (errorElement) errorElement.classList.remove('hidden');
            console.log(`[VALIDATE] Input ${input.id} invalid: ${input.value}`);
          } else {
            input.classList.remove('border-red-500');
            if (errorElement) errorElement.classList.add('hidden');
            console.log(`[VALIDATE] Input ${input.id} valid: ${input.value}`);
          }
        });

        // Special validation for Step 2-3 (symptoms)
        if (currentSet === 2) {
          const checkedSymptoms = currentStep.querySelectorAll('input[name="sintomas"]:checked');
          const symptomsError = document.getElementById('sintomas-error');
          if (checkedSymptoms.length === 0) {
            valid = false;
            if (symptomsError) symptomsError.classList.remove('hidden');
            console.log('[VALIDATE] No symptoms selected');
          } else {
            if (symptomsError) symptomsError.classList.add('hidden');
            console.log(`[VALIDATE] ${checkedSymptoms.length} symptoms selected`);
          }
        }

        if (currentSet === 1) {
          nextSet1.disabled = !valid;
          console.log(`[VALIDATE] Next button for set 1 disabled: ${!valid}`);
        } else if (currentSet === 2) {
          nextSet2.disabled = !valid;
          console.log(`[VALIDATE] Next button for set 2 disabled: ${!valid}`);
        } else {
          submitButton.disabled = !valid;
          console.log(`[VALIDATE] Submit button disabled: ${!valid}`);
        }
        return valid;
      }

      // Attach input listeners for real-time validation
      steps.forEach(step => {
        step.querySelectorAll('input, select').forEach(input => {
          input.addEventListener('input', () => {
            console.log(`[INPUT] ${input.id} changed to: ${input.value}`);
            validateSet();
          });
          input.addEventListener('change', () => {
            console.log(`[CHANGE] ${input.id} changed to: ${input.value}`);
            validateSet();
          });
        });
        if (step.id === 'step-2-3') {
          step.querySelectorAll('input[name="sintomas"]').forEach(cb => {
            cb.addEventListener('change', validateSet);
          });
        }
      });

      nextSet1.addEventListener('click', () => {
        if (validateSet()) {
          currentSet = 2;
          updateSet();
          console.log('[NAV] Moved to set 2');
        }
      });

      nextSet2.addEventListener('click', () => {
        if (validateSet()) {
          currentSet = 3;
          updateSet();
          console.log('[NAV] Moved to set 3');
        }
      });

      submitButton.addEventListener('click', (e) => {
        e.preventDefault();
        console.log('[SUBMIT] Submit button clicked');
        if (validateSet()) {
          processarDiagnostico();
        } else {
          console.log('[SUBMIT] Form invalid, cannot submit');
        }
      });

      // Conditional Fields
      document.querySelectorAll('input[name="sintomas"]').forEach(cb => {
        cb.addEventListener('change', () => {
          console.log(`[CONDITIONAL] Sintomas checkbox ${cb.value} changed`);
          const checked = document.querySelectorAll('input[name="sintomas"]:checked');
          if (checked.length > 5) {
            cb.checked = false;
            alert('Por favor, selecione apenas at√© 5 sintomas.');
            console.log('[CONDITIONAL] Exceeded 5 symptoms, unchecked');
          }
          document.getElementById('sintomas-outra').classList.toggle('hidden', !Array.from(checked).some(c => c.value === 'Outro'));
          document.getElementById('febre-details').classList.toggle('hidden', !Array.from(checked).some(c => c.value === 'Febre/Hipertermia'));
          document.getElementById('dor-details').classList.toggle('hidden', !Array.from(checked).some(c => ['Dor de Cabe√ßa', 'Dor Muscular', 'Dor Abdominal'].includes(c.value)));
          document.getElementById('tosse-details').classList.toggle('hidden', !Array.from(checked).some(c => c.value === 'Tosse'));
          document.getElementById('dispneia-details').classList.toggle('hidden', !Array.from(checked).some(c => c.value === 'Dispneia'));
          validateSet();
        });
      });

      document.querySelectorAll('input[name="cronicas"]').forEach(cb => {
        cb.addEventListener('change', () => {
          console.log(`[CONDITIONAL] Cr√¥nicas checkbox ${cb.value} changed`);
          const checked = document.querySelectorAll('input[name="cronicas"]:checked');
          if (cb.value === 'Nenhuma' && cb.checked) {
            checked.forEach(c => { if (c.value !== 'Nenhuma') c.checked = false; });
            document.getElementById('cronicas-outra').classList.add('hidden');
            console.log('[CONDITIONAL] Nenhuma selected, cleared others');
          } else if (checked.length > 0 && Array.from(checked).some(c => c.value !== 'Nenhuma')) {
            document.querySelector('input[name="cronicas"][value="Nenhuma"]').checked = false;
            document.getElementById('cronicas-outra').classList.toggle('hidden', !Array.from(checked).some(c => c.value === 'Outra'));
          }
          validateSet();
        });
      });

      document.getElementById('tabagismo').addEventListener('change', (e) => {
        console.log(`[CONDITIONAL] Tabagismo changed to ${e.target.value}`);
        document.getElementById('tabagismo-detalhes').classList.toggle('hidden', e.target.value === 'Nunca Fumou');
        validateSet();
      });

      function processarDiagnostico() {
        console.log('[DIAG] Processing diagnosis...');
        const dados = {};
        try {
          dados.sexo = document.getElementById('sexo').value || 'N√£o informado';
          dados.idade = parseInt(document.getElementById('idade').value) || 0;
          dados.peso = parseFloat(document.getElementById('peso').value) || 0;
          dados.altura = parseFloat(document.getElementById('altura').value) || 0.1;
          dados.imc = (dados.peso / (dados.altura * dados.altura)).toFixed(1) || 0;
          dados.sintomas = Array.from(document.querySelectorAll('input[name="sintomas"]:checked')).map(c => c.value === 'Outro' ? document.getElementById('sintomas-outra').value : c.value).join(', ') || 'Nenhum';
          dados.temperatura = parseFloat(document.getElementById('temperatura').value) || 0;
          dados.dor_intensidade = parseInt(document.getElementById('dor-intensidade').value) || 0;
          dados.tosse_tipo = document.getElementById('tosse-tipo').value || 'N√£o definido';
          dados.dispneia_gravidade = parseInt(document.getElementById('dispneia-gravidade').value) || 0;
          dados.duracao = document.getElementById('duracao').value || 'N√£o informado';
          dados.desencadeantes = document.getElementById('desencadeantes').value || 'Nenhum';
          dados.aliviantes = document.getElementById('aliviantes').value || 'Nenhum';
          dados.exposicao = document.getElementById('exposicao').value || 'Nenhuma';
          dados.cronicas = Array.from(document.querySelectorAll('input[name="cronicas"]:checked')).map(c => c.value === 'Outra' ? document.getElementById('cronicas-outra').value : c.value).join(', ') || 'Nenhuma';
          dados.cirurgias = document.getElementById('cirurgias').value || 'Nenhuma';
          dados.alergias = document.getElementById('alergias').value || 'Nenhuma';
          dados.medicamentos = document.getElementById('medicamentos').value || 'Nenhum';
          dados.tabagismo = document.getElementById('tabagismo').value + (document.getElementById('tabagismo-detalhes').value ? `: ${document.getElementById('tabagismo-detalhes').value}` : '') || '';
          dados.etilismo = document.getElementById('etilismo').value + (document.getElementById('etilismo-detalhes').value ? `: ${document.getElementById('etilismo-detalhes').value}` : '') || '';
          dados.atividade = document.getElementById('atividade-fisica').value || 'N√£o informado';
          dados.estresse = parseInt(document.getElementById('estresse').value) || 0;
          dados.sinais_vitais = document.getElementById('sinais-vitais').value || 'N√£o informado';
          dados.sintomas_secundarios = Array.from(document.querySelectorAll('input[name="sintomas-secundarios"]:checked')).map(c => c.value).join(', ') || 'Nenhum';
          dados.observacoes = document.getElementById('observacoes').value || 'Nenhuma';
        } catch (e) {
          console.error(`[ERROR] Data collection failed: ${e.message}`);
          return;
        }

        // Scoring system for diagnoses (unchanged)
        let scores = {
          influenza: 0,
          covid19: 0,
          bronchitis: 0,
          dengue: 0,
          tension_headache: 0
        };

        try {
          if (dados.sintomas.includes('Febre/Hipertermia')) {
            scores.influenza += 30;
            scores.covid19 += 25;
            scores.dengue += 25;
            scores.bronchitis += 15;
            if (dados.temperatura >= 38) {
              scores.influenza += 20;
              scores.covid19 += 10;
              scores.dengue += 15;
            }
          }
          if (dados.sintomas.includes('Tosse')) {
            scores.influenza += 20;
            scores.covid19 += 25;
            scores.bronchitis += 30;
            if (dados.tosse_tipo === 'Seca') {
              scores.covid19 += 15;
              scores.influenza += 10;
            } else if (dados.tosse_tipo === 'Produtiva') {
              scores.bronchitis += 20;
            }
          }
          if (dados.sintomas.includes('Dor de Cabe√ßa')) {
            scores.influenza += 15;
            scores.covid19 += 10;
            scores.dengue += 20;
            scores.tension_headache += 30;
            if (dados.dor_intensidade >= 7) {
              scores.tension_headache += 10;
              scores.dengue += 10;
            }
          }
          if (dados.sintomas.includes('Dor Muscular')) {
            scores.influenza += 25;
            scores.covid19 += 15;
            scores.dengue += 20;
            scores.tension_headache += 10;
          }
          if (['1-3 Dias', '4-7 Dias'].includes(dados.duracao)) {
            scores.influenza += 10;
            scores.covid19 += 10;
            scores.dengue += 10;
          }
          if (dados.exposicao === 'Contato com Doentes') {
            scores.influenza += 15;
            scores.covid19 += 15;
            scores.bronchitis += 10;
          }
          if (dados.exposicao === '√Årea com Surtos') {
            scores.dengue += 15;
          }

          console.log('[DIAG] Scores:', scores);

          // Generate diagnosis output (unchanged)
          const possiveisDiagnosticos = [];
          if (scores.dengue >= 50) {
            possiveisDiagnosticos.push({
              nome: 'Dengue',
              probabilidade: Math.min(80, scores.dengue),
              recomendacao: 'Procure um m√©dico para exames de sangue (hemograma) e avalia√ß√£o de plaquetas. Hidrate-se bem.'
            });
          }
          if (scores.influenza >= 50) {
            possiveisDiagnosticos.push({
              nome: 'Influenza (Gripe)',
              probabilidade: Math.min(75, scores.influenza),
              recomendacao: 'Repouse, mantenha-se hidratado e monitore a febre. Procure atendimento se persistir por mais de 4 dias.'
            });
          }
          if (scores.covid19 >= 50) {
            possiveisDiagnosticos.push({
              nome: 'COVID-19',
              probabilidade: Math.min(55, scores.covid19),
              recomendacao: 'Realize um teste PCR ou ant√≠geno imediatamente. Isole-se e contate um servi√ßo de sa√∫de. Monitore oxigena√ß√£o e sintomas respirat√≥rios.'
            });
          }
          if (scores.tension_headache >= 40) {
            possiveisDiagnosticos.push({
              nome: 'Cefaleia Tensional',
              probabilidade: Math.min(40, scores.tension_headache),
              recomendacao: 'Tente relaxar e hidrate-se. Consulte um m√©dico se a dor persistir.'
            });
          }

          possiveisDiagnosticos.sort((a, b) => b.probabilidade - a.probabilidade);

          let output = `
            <h3 class="text-lg font-bold text-[#22d3ee] mb-3">Resumo dos Dados</h3>
            <ul class="list-disc pl-6 mb-4 text-gray-300">
              <li><strong>Sexo:</strong> ${dados.sexo}</li>
              <li><strong>Idade:</strong> ${dados.idade} anos</li>
              <li><strong>Peso:</strong> ${dados.peso} kg</li>
              <li><strong>Altura:</strong> ${dados.altura} m</li>
              <li><strong>IMC:</strong> ${dados.imc} (Normal)</li>
              <li><strong>Sintomas:</strong> ${dados.sintomas}</li>
            </ul>
            <h3 class="text-lg font-bold text-[#22d3ee] mb-3">Poss√≠veis Diagn√≥sticos (Ordenados por Probabilidade)</h3>
            <ul class="list-decimal pl-6 text-gray-300">
          `;
          if (possiveisDiagnosticos.length === 0) {
            output += '<li>Nenhum diagn√≥stico prov√°vel identificado. Consulte um m√©dico para avalia√ß√£o detalhada.</li>';
          } else {
            possiveisDiagnosticos.forEach((diag, index) => {
              output += `
                <li class="mb-2">
                  <strong>${diag.nome}</strong> (<span class="text-[#22d3ee]">${diag.probabilidade}%</span>)<br>
                  <span>${diag.recomendacao}</span>
                </li>
              `;
            });
          }
          output += '</ul>';

          document.getElementById('resposta-diagnostico').innerHTML = output;
          document.getElementById('resultado-diagnostico').classList.remove('hidden');
          console.log('[DIAG] Diagnosis displayed');
        } catch (error) {
          console.error(`[ERROR] Diagnosis processing failed: ${error.message}`);
        }
      }

      // Menu Mobile
      const hamburgerMenu = document.getElementById('hamburger-menu');
      const mobileMenu = document.getElementById('mobile-menu');
      const servicesToggle = document.getElementById('services-toggle');
      const servicesMenu = document.getElementById('services-menu');

      hamburgerMenu.addEventListener('click', () => {
        mobileMenu.classList.toggle('hidden');
      });

      servicesToggle.addEventListener('click', () => {
        servicesMenu.classList.toggle('hidden');
      });

      // Initialize
      console.log('[INIT] Starting form initialization');
      updateSet();
      console.log('[INIT] Form initialized successfully');
    });
  </script>
</body>
</html>
