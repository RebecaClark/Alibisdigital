<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Diagnóstico Médico Avançado com IA</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/particles.js@2.0.0/particles.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@latest"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/dsp.js/1.0.0/dsp.min.js" onerror="console.warn('dsp.js failed to load')"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        html { scroll-behavior: smooth; }
        body {
            position: relative;
            overflow-x: hidden;
            font-family: 'Inter', sans-serif;
            background: transparent;
        }
        #particles-js {
            position: absolute;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
            z-index: -1;
            background: linear-gradient(135deg, #0b1120, #1e1b4b, #2e1065);
        }
        .fade-in { animation: fadeIn 1s ease-in-out; }
        .pulse { animation: pulse 2s infinite ease-in-out; }
        .shine { position: relative; overflow: hidden; }
        .shine::after {
            content: ''; position: absolute; top: -50%; left: -50%; width: 200%; height: 200%;
            background: linear-gradient(45deg, rgba(255, 255, 255, 0), rgba(255, 255, 255, 0.3), rgba(255, 255, 255, 0));
            transform: rotate(20deg); animation: shine 4s infinite linear;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.03); }
            100% { transform: scale(1); }
        }
        @keyframes shine {
            0% { transform: translateX(-100%) rotate(45deg); }
            100% { transform: translateX(100%) rotate(45deg); }
        }
        .holo-nav {
            background: rgba(17, 24, 39, 0.85);
            backdrop-filter: blur(10px);
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            animation: holoGlow 2s infinite alternate;
        }
        @keyframes holoGlow {
            0% { box-shadow: 0 0 8px #22d3ee; }
            100% { box-shadow: 0 0 15px #22d3ee; }
        }
        .holo-nav a, .holo-nav button {
            transition: color 0.3s ease;
        }
        .holo-nav a:hover, .holo-nav button:hover {
            color: #22d3ee;
            text-shadow: 0 0 5px #22d3ee;
        }
        .futuristic-btn {
            background: linear-gradient(45deg, #7C3AED, #22d3ee);
            box-shadow: 0 0 8px #22d3ee;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            animation: neonPulse 1.5s infinite alternate;
        }
        .futuristic-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 0 20px #22d3ee, 0 0 30px #22d3ee;
        }
        @keyframes neonPulse {
            from { box-shadow: 0 0 5px #22d3ee; }
            to { box-shadow: 0 0 15px #22d3ee; }
        }
        .form-input, .form-textarea {
            background: rgba(55, 65, 81, 0.8);
            border: 1px solid #22d3ee;
            border-radius: 8px;
            padding: 12px;
            color: white;
            width: 100%;
            transition: border-color 0.3s, box-shadow 0.3s;
        }
        .form-input:focus, .form-textarea:focus {
            outline: none;
            border-color: #22d3ee;
            box-shadow: 0 0 8px #22d3ee;
        }
        .screen {
            display: none;
            opacity: 0;
            transition: opacity 0.5s ease;
        }
        .screen.active {
            display: block;
            opacity: 1;
        }
        .symptom-list {
            display: flex;
            flex-direction: column;
            gap: 12px;
            max-height: 300px;
            overflow-y: auto;
            padding: 8px;
            background: rgba(31, 41, 55, 0.5);
            border-radius: 8px;
        }
        .symptom-item {
            display: flex;
            align-items: center;
            padding: 8px;
            border-radius: 4px;
            transition: background 0.2s;
        }
        .symptom-item:hover {
            background: rgba(34, 211, 238, 0.1);
        }
        .symptom-list input[type="checkbox"] {
            appearance: none;
            width: 18px;
            height: 18px;
            background-color: rgba(55, 65, 81, 0.8);
            border: 1px solid #22d3ee;
            border-radius: 4px;
            cursor: pointer;
            position: relative;
            transition: background-color 0.2s, border-color 0.2s;
        }
        .symptom-list input[type="checkbox"]:checked {
            background-color: #22d3ee;
            border-color: #22d3ee;
        }
        .symptom-list input[type="checkbox"]:checked::after {
            content: '\2713';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: #0b1120;
            font-size: 14px;
            font-weight: bold;
        }
        .symptom-list label {
            color: #e5e7eb;
            cursor: pointer;
            margin-left: 8px;
            font-size: 0.875rem;
            transition: color 0.2s;
        }
        .symptom-list label:hover {
            color: #22d3ee;
        }
        .neon-border {
            border: 1px solid rgba(34, 211, 238, 0.3);
            position: relative;
            overflow: hidden;
        }
        .neon-border::after {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(34, 211, 238, 0.1), transparent);
            transition: 0.5s;
        }
        .neon-border:hover::after {
            left: 100%;
        }
        .health-card {
            background: rgba(31, 41, 55, 0.7);
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 15px;
            transition: all 0.3s ease;
            border-left: 3px solid #22d3ee;
        }
        .health-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);
        }
        .action-card {
            background: rgba(17, 24, 39, 0.8);
            border-radius: 8px;
            padding: 15px;
            transition: all 0.3s ease;
            border-top: 2px solid #7C3AED;
        }
        .action-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(124, 58, 237, 0.2);
        }
        .scanner-btn {
            background: linear-gradient(45deg, #7C3AED, #22d3ee);
            color: white;
            padding: 10px;
            border-radius: 8px;
            text-align: center;
            transition: transform 0.3s ease;
        }
        .scanner-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 0 10px #22d3ee;
        }
        .dimension-card {
            background: rgba(31, 41, 55, 0.7);
            padding: 15px;
            border-radius: 8px;
            border-left: 3px solid #22d3ee;
        }
        .score {
            font-size: 1.5rem;
            color: #22d3ee;
        }
        .high-contrast {
            --tw-bg-opacity: 1;
            background-color: rgb(0 0 0 / var(--tw-bg-opacity)) !important;
            color: white !important;
        }
        .high-contrast .form-input,
        .high-contrast .form-textarea {
            background-color: black !important;
            border: 2px solid white !important;
            color: white !important;
        }
        .high-contrast .futuristic-btn {
            background: white !important;
            color: black !important;
        }
        @media (max-width: 768px) {
            .holo-nav .header-right { flex-direction: column; align-items: flex-end; }
            h1 { font-size: 2.25rem; line-height: 2.5rem; }
            h2 { font-size: 1.5rem; }
            .futuristic-btn { width: 100%; margin-bottom: 0.5rem; font-size: 0.875rem; padding: 0.75rem; }
            .symptom-list { max-height: 250px; }
            .symptom-list input[type="checkbox"] { width: 16px; height: 16px; }
            .symptom-list label { font-size: 0.75rem; }
        }
        @media (max-width: 480px) {
            h1 { font-size: 1.75rem; line-height: 2rem; }
            h2 { font-size: 1.25rem; }
            .futuristic-btn { font-size: 0.75rem; padding: 0.5rem; }
            .form-input, .form-textarea { padding: 8px; }
            .symptom-list { max-height: 200px; }
            .symptom-list input[type="checkbox"] { width: 14px; height: 14px; }
            .symptom-list label { font-size: 0.75rem; }
        }
    </style>
</head>
<body class="text-white">
    <div id="particles-js"></div>
    <header class="holo-nav fixed top-0 left-0 w-full z-50 transition-shadow duration-300">
        <div class="max-w-7xl mx-auto px-6 py-4 flex justify-between items-center">
            <div class="flex items-center space-x-3">
                <a href="/index.html" aria-label="Página inicial da Álibis Digital">
                    <img src="/assets/logo.png" alt="Logo da Álibis Digital" class="h-10 w-auto">
                </a>
            </div>
            <div class="flex items-center space-x-3">
                <div class="md:hidden">
                    <button id="hamburger-menu" class="text-white focus:outline-none p-2 rounded" aria-label="Abrir menu de navegação">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />
                        </svg>
                    </button>
                </div>
            </div>
            <nav id="navbar" class="hidden md:flex space-x-4 text-sm items-center">
                <a href="/blog.html" class="hover:text-[#22d3ee] transition">Blog</a>
                <a href="/alibi.html" class="hover:text-[#22d3ee] transition">Criar Álibi</a>
                <a href="/scanner.html" class="hover:text-[#22d3ee] transition">Scanner com IA</a>
                <a href="/apoio-emocional.html" class="hover:text-[#22d3ee] transition">Apoio Emocional</a>
                <a href="/suporte.html" class="hover:text-[#22d3ee] transition">Suporte</a>
                <a href="/login.html" class="futuristic-btn text-white py-2 px-4 rounded-full text-sm font-semibold" aria-label="Fazer login">Login</a>
                <a href="/criar-conta.html" class="futuristic-btn text-white py-2 px-4 rounded-full text-sm font-semibold bounce-in" aria-label="Criar conta">Criar Conta</a>
            </nav>
        </div>
        <div id="mobile-menu" class="md:hidden bg-[rgba(31,41,55,0.9)] w-full hidden py-4">
            <nav class="flex flex-col items-center space-y-4">
                <a href="/blog.html" class="text-white py-2 px-4 text-lg w-full text-center hover:bg-gray-700 rounded">Blog</a>
                <a href="/alibi.html" class="text-white py-2 px-4 text-lg w-full text-center hover:bg-gray-700 rounded">Criar Álibi</a>
                <a href="/scanner.html" class="text-white py-2 px-4 text-lg w-full text-center hover:bg-gray-700 rounded">Scanner com IA</a>
                <a href="/apoio-emocional.html" class="text-white py-2 px-4 text-lg w-full text-center hover:bg-gray-700 rounded">Apoio Emocional</a>
                <a href="/suporte.html" class="text-white py-2 px-4 text-lg w-full text-center hover:bg-gray-700 rounded">Suporte</a>
            </nav>
        </div>
    </header>
    <div class="h-20"></div>

    <section id="avaliacao-emocional" class="py-20 px-6">
        <div class="max-w-3xl mx-auto text-center">
            <h2 class="text-4xl font-bold mb-4 text-[#22d3ee] fade-in shine">Medical IA - Diagnóstico Médico Avançado com IA</h2>
            <p class="text-white mb-4 text-center">Obtenha um pré-diagnóstico avançado com tecnologia de ponta. Responda ao questionário abaixo.</p>
            <div class="neon-box mt-6 max-w-4xl mx-auto p-8 bg-gray-800 bg-opacity-80 backdrop-filter backdrop-blur-sm">
                <form id="diagnostico-form">
                    <!-- Step 1: Dados Demográficos -->
                    <div id="step-1" class="step active">
                        <div class="instructions text-gray-400 mb-4">
                            Forneça suas informações básicas para começar. Esses dados ajudam a personalizar seu pré-diagnóstico.
                        </div>
                        <div class="form-group mb-4">
                            <label class="required text-white" for="sexo">Sexo Biológico</label>
                            <select id="sexo" required class="form-input">
                                <option value="">Selecione...</option>
                                <option value="Masculino">Masculino</option>
                                <option value="Feminino">Feminino</option>
                            </select>
                            <div id="sexo-error" class="error-message text-red-500 mt-1 hidden">Por favor, selecione uma opção.</div>
                        </div>
                        <div class="form-group mb-4">
                            <label class="required text-white" for="idade">Idade (anos)</label>
                            <input id="idade" type="number" min="0" max="120" placeholder="Ex.: 40" required class="form-input">
                            <div id="idade-error" class="error-message text-red-500 mt-1 hidden">Por favor, informe sua idade.</div>
                        </div>
                        <div class="form-group mb-4">
                            <label class="required text-white">Peso (kg) e Altura (m)</label>
                            <div class="flex gap-4">
                                <div class="flex-1">
                                    <input id="peso" type="number" step="0.1" min="0" placeholder="Ex.: 70" required class="form-input">
                                    <div id="peso-error" class="error-message text-red-500 mt-1 hidden">Por favor, informe seu peso.</div>
                                </div>
                                <div class="flex-1">
                                    <input id="altura" type="number" step="0.01" min="0" placeholder="Ex.: 1.80" required class="form-input">
                                    <div id="altura-error" class="error-message text-red-500 mt-1 hidden">Por favor, informe sua altura.</div>
                                </div>
                            </div>
                        </div>
                        <div class="form-group mb-4">
                            <label class="text-white">Scanner Corporal (Opcional)</label>
                            <div class="scanner-options grid grid-cols-2 gap-4 mt-2">
                                <button type="button" class="scanner-btn futuristic-btn" onclick="activateCameraScanner('pele')">
                                    <i class="fas fa-camera"></i> Analisar Pele
                                </button>
                                <button type="button" class="scanner-btn futuristic-btn" onclick="activateVoiceAnalysis()">
                                    <i class="fas fa-microphone"></i> Análise de Voz
                                </button>
                            </div>
                            <div id="scanner-results" class="hidden mt-4">
                                <h4 class="text-sm font-semibold text-[#22d3ee]">Resultados do Scanner:</h4>
                                <div id="scanner-feedback" class="text-gray-200"></div>
                            </div>
                        </div>
                        <button type="button" class="futuristic-btn text-white py-2 px-4 rounded-full text-sm font-semibold mt-4" onclick="nextStep(2)">Próximo</button>
                    </div>

                    <!-- Step 2: Sintomas Principais -->
                    <div id="step-2" class="step">
                        <div class="instructions text-gray-400 mb-4">
                            Selecione até 5 sintomas principais que você está enfrentando. Forneça detalhes adicionais quando solicitado.
                        </div>
                        <div class="form-group mb-4">
                            <label class="required text-white mb-2 block">Sintomas Principais (Selecione até 5)</label>
                            <div class="symptom-list">
                                <div class="symptom-item"><input type="checkbox" name="sintomas" value="Febre/Hipertermia" id="sintoma-fiebre"><label for="sintoma-fiebre">Febre/Hipertermia</label></div>
                                <div class="symptom-item"><input type="checkbox" name="sintomas" value="Tosse" id="sintoma-tosse"><label for="sintoma-tosse">Tosse</label></div>
                                <div class="symptom-item"><input type="checkbox" name="sintomas" value="Dispneia" id="sintoma-dispneia"><label for="sintoma-dispneia">Dispneia (Falta de Ar)</label></div>
                                <div class="symptom-item"><input type="checkbox" name="sintomas" value="Dor de Cabeça" id="sintoma-dor-cabeca"><label for="sintoma-dor-cabeca">Dor de Cabeça</label></div>
                                <div class="symptom-item"><input type="checkbox" name="sintomas" value="Dor Muscular" id="sintoma-dor-muscular"><label for="sintoma-dor-muscular">Dor Muscular/Articular</label></div>
                                <div class="symptom-item"><input type="checkbox" name="sintomas" value="Fadiga" id="sintoma-fadiga"><label for="sintoma-fadiga">Fadiga (Cansaço Extremo)</label></div>
                                <div class="symptom-item"><input type="checkbox" name="sintomas" value="Náusea/Vômito" id="sintoma-nausea"><label for="sintoma-nausea">Náusea/Vômito</label></div>
                                <div class="symptom-item"><input type="checkbox" name="sintomas" value="Dor Abdominal" id="sintoma-dor-abdominal"><label for="sintoma-dor-abdominal">Dor Abdominal</label></div>
                                <div class="symptom-item"><input type="checkbox" name="sintomas" value="Manchas Cutâneas" id="sintoma-manchas"><label for="sintoma-manchas">Manchas Cutâneas</label></div>
                                <div class="symptom-item"><input type="checkbox" name="sintomas" value="Icterícia" id="sintoma-ictericia"><label for="sintoma-ictericia">Icterícia</label></div>
                                <div class="symptom-item"><input type="checkbox" name="sintomas" value="Outro" id="sintoma-outro"><label for="sintoma-outro">Outro</label></div>
                            </div>
                            <div id="sintomas-error" class="error-message text-red-500 mt-1 hidden">Por favor, selecione pelo menos um sintoma.</div>
                            <input id="sintomas-outra" type="text" class="form-input mt-2 hidden" placeholder="Especifique o sintoma">
                        </div>
                        <div class="form-group mb-4 hidden" id="febre-details">
                            <label class="text-white" for="temperatura">Temperatura Máxima (°C)</label>
                            <input id="temperatura" type="number" step="0.1" min="35" max="42" placeholder="Ex.: 38.5" class="form-input">
                        </div>
                        <div class="form-group mb-4 hidden" id="dor-details">
                            <label class="text-white" for="dor-intensidade">Intensidade da Dor (0-10)</label>
                            <input id="dor-intensidade" type="number" min="0" max="10" placeholder="Ex.: 7" class="form-input">
                        </div>
                        <div class="form-group mb-4 hidden" id="tosse-details">
                            <label class="text-white" for="tosse-tipo">Tipo de Tosse</label>
                            <select id="tosse-tipo" class="form-input">
                                <option value="">Selecione...</option>
                                <option value="Seca">Seca</option>
                                <option value="Produtiva">Produtiva (com secreção)</option>
                            </select>
                        </div>
                        <div class="form-group mb-4 hidden" id="dispneia-details">
                            <label class="text-white" for="dispneia-gravidade">Gravidade da Dispneia (0-4)</label>
                            <select id="dispneia-gravidade" class="form-input">
                                <option value="0">0: Sem falta de ar</option>
                                <option value="1">1: Leve, só em esforços intensos</option>
                                <option value="2">2: Moderada, ao caminhar rápido</option>
                                <option value="3">3: Grave, ao caminhar devagar</option>
                                <option value="4">4: Muito grave, em repouso</option>
                            </select>
                        </div>
                        <div class="flex justify-between">
                            <button type="button" class="futuristic-btn text-white py-2 px-4 rounded-full text-sm font-semibold mt-4" onclick="prevStep(1)">Anterior</button>
                            <button type="button" class="futuristic-btn text-white py-2 px-4 rounded-full text-sm font-semibold mt-4" onclick="nextStep(3)">Próximo</button>
                        </div>
                    </div>

                    <!-- Step 3: Contexto dos Sintomas -->
                    <div id="step-3" class="step">
                        <div class="instructions text-gray-400 mb-4">
                            Descreva o contexto dos seus sintomas, incluindo duração e fatores relacionados.
                        </div>
                        <div class="form-group mb-4">
                            <label class="required text-white" for="duracao">Duração dos Sintomas</label>
                            <select id="duracao" required class="form-input">
                                <option value="">Selecione...</option>
                                <option value="Horas">Horas</option>
                                <option value="1-3 Dias">1-3 Dias</option>
                                <option value="4-7 Dias">4-7 Dias</option>
                                <option value="8-14 Dias">8-14 Dias</option>
                                <option value="Mais de 14 Dias">Mais de 14 Dias</option>
                                <option value="Crônica">Crônica (>3 meses)</option>
                            </select>
                            <div id="duracao-error" class="error-message text-red-500 mt-1 hidden">Por favor, selecione a duração.</div>
                        </div>
                        <div class="form-group mb-4">
                            <label class="text-white" for="desencadeantes">Fatores Desencadeantes ou Agravantes</label>
                            <input id="desencadeantes" type="text" placeholder="Ex.: frio, esforço físico" class="form-input">
                        </div>
                        <div class="form-group mb-4">
                            <label class="text-white" for="aliviantes">Fatores Aliviantes</label>
                            <input id="aliviantes" type="text" placeholder="Ex.: repouso" class="form-input">
                        </div>
                        <div class="form-group mb-4">
                            <label class="required text-white" for="exposicao">Contexto de Exposição</label>
                            <select id="exposicao" required class="form-input">
                                <option value="Nenhuma">Nenhuma</option>
                                <option value="Viagem Internacional">Viagem Internacional</option>
                                <option value="Contato com Doentes">Contato com Doentes</option>
                                <option value="Água Contaminada">Água Contaminada (ex.: enchentes)</option>
                                <option value="Animais ou Insetos">Animais ou Insetos (ex.: mosquitos)</option>
                                <option value="Área com Surtos">Área com Surtos (ex.: Dengue)</option>
                            </select>
                            <div id="exposicao-error" class="error-message text-red-500 mt-1 hidden">Por favor, selecione uma opção.</div>
                        </div>
                        <div class="flex justify-between">
                            <button type="button" class="futuristic-btn text-white py-2 px-4 rounded-full text-sm font-semibold mt-4" onclick="prevStep(2)">Anterior</button>
                            <button type="button" class="futuristic-btn text-white py-2 px-4 rounded-full text-sm font-semibold mt-4" onclick="nextStep(4)">Próximo</button>
                        </div>
                    </div>

                    <!-- Step 4: Doenças Crônicas -->
                    <div id="step-4" class="step">
                        <div class="instructions text-gray-400 mb-4">
                            Informe suas condições médicas preexistentes e histórico de saúde.
                        </div>
                        <div class="form-group mb-4">
                            <label class="text-white">Doenças Crônicas</label>
                            <div class="checkbox-grid grid grid-cols-2 gap-2">
                                <label class="flex items-center"><input type="checkbox" name="cronicas" value="Nenhuma" checked class="mr-2"> Nenhuma</label>
                                <label class="flex items-center"><input type="checkbox" name="cronicas" value="Diabetes" class="mr-2"> Diabetes</label>
                                <label class="flex items-center"><input type="checkbox" name="cronicas" value="Hipertensão" class="mr-2"> Hipertensão</label>
                                <label class="flex items-center"><input type="checkbox" name="cronicas" value="Asma" class="mr-2"> Asma</label>
                                <label class="flex items-center"><input type="checkbox" name="cronicas" value="Doença do Coração" class="mr-2"> Doença do Coração</label>
                                <label class="flex items-center"><input type="checkbox" name="cronicas" value="Depressão" class="mr-2"> Depressão</label>
                                <label class="flex items-center"><input type="checkbox" name="cronicas" value="Enxaqueca" class="mr-2"> Enxaqueca</label>
                                <label class="flex items-center"><input type="checkbox" name="cronicas" value="Outra" class="mr-2"> Outra</label>
                            </div>
                            <input id="cronicas-outra" type="text" class="form-input mt-2 hidden" placeholder="Ex.: Especificar (ex.: artrite)">
                        </div>
                        <div class="form-group mb-4">
                            <label class="text-white" for="cirurgias">Cirurgias Prévias</label>
                            <input id="cirurgias" type="text" placeholder="Ex.: apendicectomia em 2010" class="form-input">
                        </div>
                        <div class="form-group mb-4">
                            <label class="text-white" for="alergias">Alergias Medicamentosas ou Ambientais</label>
                            <input id="alergias" type="text" placeholder="Ex.: penicilina, pólen" class="form-input">
                        </div>
                        <div class="form-group mb-4">
                            <label class="text-white" for="medicamentos">Medicamentos em Uso</label>
                            <input id="medicamentos" type="text" placeholder="Ex.: Losartana 50 mg, 1x/dia" class="form-input">
                        </div>
                        <div class="flex justify-between">
                            <button type="button" class="futuristic-btn text-white py-2 px-4 rounded-full text-sm font-semibold mt-4" onclick="prevStep(3)">Anterior</button>
                            <button type="button" class="futuristic-btn text-white py-2 px-4 rounded-full text-sm font-semibold mt-4" onclick="nextStep(5)">Próximo</button>
                        </div>
                    </div>

                    <!-- Step 5: Estilo de Vida -->
                    <div id="step-5" class="step">
                        <div class="instructions text-gray-400 mb-4">
                            Detalhe seu estilo de vida para ajudar na avaliação do seu estado de saúde.
                        </div>
                        <div class="form-group mb-4">
                            <label class="required text-white" for="tabagismo">Tabagismo</label>
                            <select id="tabagismo" required class="form-input">
                                <option value="Nunca Fumou">Nunca Fumou</option>
                                <option value="Ex-Fumante">Ex-Fumante</option>
                                <option value="Fumante Ativo">Fumante Ativo</option>
                            </select>
                            <div id="tabagismo-error" class="error-message text-red-500 mt-1 hidden">Por favor, selecione uma opção.</div>
                            <input id="tabagismo-detalhes" type="text" class="form-input mt-2 hidden" placeholder="Ex.: 20 maços-ano">
                        </div>
                        <div class="form-group mb-4">
                            <label class="required text-white" for="etilismo">Etilismo</label>
                            <select id="etilismo" required class="form-input">
                                <option value="Não Bebe">Não Bebe</option>
                                <option value="Uso Social">Uso Social</option>
                                <option value="Uso Regular">Uso Regular</option>
                            </select>
                            <div id="etilismo-error" class="error-message text-red-500 mt-1 hidden">Por favor, selecione uma opção.</div>
                            <input id="etilismo-detalhes" type="text" class="form-input mt-2 hidden" placeholder="Ex.: 2 doses/semana">
                        </div>
                        <div class="form-group mb-4">
                            <label class="required text-white" for="atividade-fisica">Atividade Física</label>
                            <select id="atividade-fisica" required class="form-input">
                                <option value="Sedentário">Sedentário</option>
                                <option value="Leve">Leve (ex.: caminhada 2x/semana)</option>
                                <option value="Moderada">Moderada (ex.: academia 3-4x/semana)</option>
                                <option value="Intensa">Intensa (ex.: treino diário)</option>
                            </select>
                            <div id="atividade-fisica-error" class="error-message text-red-500 mt-1 hidden">Por favor, selecione uma opção.</div>
                        </div>
                        <div class="form-group mb-4">
                            <label class="text-white" for="estresse">Nível de Estresse (0-5)</label>
                            <input id="estresse" type="number" min="0" max="5" placeholder="0 = Nenhum, 5 = Extremo" class="form-input">
                        </div>
                        <div class="flex justify-between">
                            <button type="button" class="futuristic-btn text-white py-2 px-4 rounded-full text-sm font-semibold mt-4" onclick="prevStep(4)">Anterior</button>
                            <button type="button" class="futuristic-btn text-white py-2 px-4 rounded-full text-sm font-semibold mt-4" onclick="nextStep(6)">Próximo</button>
                        </div>
                    </div>

                    <!-- Step 6: Revisão de Sistemas -->
                    <div id="step-6" class="step">
                        <div class="instructions text-gray-400 mb-4">
                            Informe sintomas adicionais ou observações para completar sua avaliação.
                        </div>
                        <div class="form-group mb-4">
                            <label class="text-white" for="sinais-vitais">Sinais Vitais Recentes (opcional)</label>
                            <input id="sinais-vitais" type="text" placeholder="Ex.: PA 130/80 mmHg, FC 72 bpm" class="form-input">
                        </div>
                        <div class="form-group mb-4">
                            <label class="text-white mb-2 block">Sintomas Secundários</label>
                            <div class="symptom-list">
                                <div class="symptom-item"><input type="checkbox" name="sintomas-secundarios" value="Perda de Paladar/Olfato" id="sintoma-sec-perda-padar"><label for="sintoma-sec-perda-padar">Perda de Paladar/Olfato</label></div>
                                <div class="symptom-item"><input type="checkbox" name="sintomas-secundarios" value="Dor de Garganta" id="sintoma-sec-dor-garganta"><label for="sintoma-sec-dor-garganta">Dor de Garganta</label></div>
                                <div class="symptom-item"><input type="checkbox" name="sintomas-secundarios" value="Coriza" id="sintoma-sec-coriza"><label for="sintoma-sec-coriza">Coriza</label></div>
                                <div class="symptom-item"><input type="checkbox" name="sintomas-secundarios" value="Diarreia" id="sintoma-sec-diarreia"><label for="sintoma-sec-diarreia">Diarreia</label></div>
                                <div class="symptom-item"><input type="checkbox" name="sintomas-secundarios" value="Tontura" id="sintoma-sec-tontura"><label for="sintoma-sec-tontura">Tontura</label></div>
                                <div class="symptom-item"><input type="checkbox" name="sintomas-secundarios" value="Perda de Peso Involuntária" id="sintoma-sec-perda-peso"><label for="sintoma-sec-perda-peso">Perda de Peso Involuntária</label></div>
                                <div class="symptom-item"><input type="checkbox" name="sintomas-secundarios" value="Suores Noturnos" id="sintoma-sec-suores"><label for="sintoma-sec-suores">Suores Noturnos</label></div>
                                <div class="symptom-item"><input type="checkbox" name="sintomas-secundarios" value="Confusão Mental" id="sintoma-sec-confusao"><label for="sintoma-sec-confusao">Confusão Mental</label></div>
                                <div class="symptom-item"><input type="checkbox" name="sintomas-secundarios" value="Tremor" id="sintoma-sec-tremor"><label for="sintoma-sec-tremor">Tremor</label></div>
                                <div class="symptom-item"><input type="checkbox" name="sintomas-secundarios" value="Tristeza Persistente" id="sintoma-sec-tristeza"><label for="sintoma-sec-tristeza">Tristeza Persistente</label></div>
                                <div class="symptom-item"><input type="checkbox" name="sintomas-secundarios" value="Manchas Anestésicas" id="sintoma-sec-manchas"><label for="sintoma-sec-manchas">Manchas Anestésicas</label></div>
                                <div class="symptom-item"><input type="checkbox" name="sintomas-secundarios" value="Sede Excessiva" id="sintoma-sec-sede"><label for="sintoma-sec-sede">Sede Excessiva</label></div>
                            </div>
                        </div>
                        <div class="form-group mb-4">
                            <label class="text-white" for="observacoes">Observações Adicionais</label>
                            <textarea id="observacoes" placeholder="Ex.: sintomas começaram após viagem" class="form-textarea"></textarea>
                        </div>
                        <div class="flex justify-between">
                            <button type="button" class="futuristic-btn text-white py-2 px-4 rounded-full text-sm font-semibold mt-4" onclick="prevStep(5)">Anterior</button>
                            <button type="button" class="futuristic-btn text-white py-2 px-4 rounded-full text-sm font-semibold mt-4" onclick="processarDiagnostico()">Obter Diagnóstico</button>
                        </div>
                    </div>
                </form>
                <div id="holistic-dashboard" class="mt-8 p-6 bg-gray-800 bg-opacity-80 backdrop-filter backdrop-blur-sm rounded-lg neon-border hidden">
                    <div class="dashboard-header mb-6">
                        <h3 class="text-xl font-bold text-[#22d3ee] mb-4">📊 Seu Painel de Saúde Integral</h3>
                        <div class="health-score text-center">
                            <div class="score-value text-4xl font-bold text-[#22d3ee]" id="overall-health-score">0</div>
                            <div class="score-label text-gray-400">Score de Saúde Geral</div>
                            <div class="health-status mt-2" id="health-status"></div>
                        </div>
                    </div>
                    
                    <div class="health-dimensions grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
                        <div class="dimension-card physical">
                            <h4 class="font-semibold mb-2">Física <span class="score" id="physical-score">0</span></h4>
                            <canvas id="physical-chart" height="100"></canvas>
                        </div>
                        <div class="dimension-card emotional">
                            <h4 class="font-semibold mb-2">Emocional <span class="score" id="emotional-score">0</span></h4>
                            <canvas id="emotional-chart" height="100"></canvas>
                        </div>
                        <div class="dimension-card metabolic">
                            <h4 class="font-semibold mb-2">Metabólica <span class="score" id="metabolic-score">0</span></h4>
                            <canvas id="metabolic-chart" height="100"></canvas>
                        </div>
                        <div class="dimension-card environmental">
                            <h4 class="font-semibold mb-2">Ambiental <span class="score" id="environmental-score">0</span></h4>
                            <canvas id="environmental-chart" height="100"></canvas>
                        </div>
                    </div>
                    
                    <div class="diagnosis-section mt-6 action-card">
                        <h4 class="font-semibold mb-2 text-white">🔍 Diagnóstico Principal</h4>
                        <div id="primary-diagnosis" class="text-gray-200"></div>
                        <div class="mt-3" id="diagnosis-confidence"></div>
                    </div>
                    
                    <div class="action-plan mt-6 action-card">
                        <h4 class="font-semibold mb-2 text-white">📌 Plano de Ação Integrado</h4>
                        <div class="plan-grid grid grid-cols-1 md:grid-cols-3 gap-4">
                            <div class="medical-actions">
                                <h5 class="text-[#22d3ee] mb-2">💊 Medicina</h5>
                                <ul id="medical-actions" class="list-disc pl-5 space-y-2 text-gray-200"></ul>
                            </div>
                            <div class="lifestyle-actions">
                                <h5 class="text-[#22d3ee] mb-2">🏃 Estilo de Vida</h5>
                                <ul id="lifestyle-actions" class="list-disc pl-5 space-y-2 text-gray-200"></ul>
                            </div>
                            <div class="monitoring-actions">
                                <h5 class="text-[#22d3ee] mb-2">📅 Monitoramento</h5>
                                <ul id="monitoring-actions" class="list-disc pl-5 space-y-2 text-gray-200"></ul>
                            </div>
                        </div>
                    </div>
                    
                    <div class="timeline-section mt-6">
                        <h4 class="font-semibold mb-2 text-white">⏳ Linha do Tempo de Saúde</h4>
                        <canvas id="health-timeline-chart"></canvas>
                    </div>
                    
                    <button id="export-report" class="futuristic-btn mt-6 w-full">
                        <i class="fas fa-file-pdf mr-2"></i> Exportar Relatório Completo
                    </button>
                </div>
            </div>
        </div>
    </section>

    <script>
        // Inicialização do Particles.js
        particlesJS('particles-js', {
            particles: {
                number: { value: 80, density: { enable: true, value_area: 800 } },
                color: { value: '#22d3ee' },
                shape: { type: 'circle' },
                opacity: { value: 0.5, random: false },
                size: { value: 3, random: true },
                line_linked: { enable: true, distance: 150, color: '#22d3ee', opacity: 0.4, width: 1 },
                move: { enable: true, speed: 2, direction: 'none', random: false }
            },
            interactivity: {
                detect_on: 'canvas',
                events: { onhover: { enable: true, mode: 'repulse' }, onclick: { enable: true, mode: 'push' } },
                modes: { repulse: { distance: 100, duration: 0.4 }, push: { particles_nb: 4 } }
            },
            retina_detect: true
        });

        // Navegação do formulário
        let currentStep = 1;
        function nextStep(step) {
            if (validateStep(currentStep)) {
                document.getElementById(`step-${currentStep}`).classList.remove('active');
                document.getElementById(`step-${step}`).classList.add('active');
                currentStep = step;
                toggleSymptomDetails();
                saveFormProgress();
            }
        }

        function prevStep(step) {
            document.getElementById(`step-${currentStep}`).classList.remove('active');
            document.getElementById(`step-${step}`).classList.add('active');
            currentStep = step;
            toggleSymptomDetails();
        }

        // Validação do formulário
        function validateStep(step) {
            let isValid = true;
            if (step === 1) {
                const sexo = document.getElementById('sexo').value;
                const idade = document.getElementById('idade').value;
                const peso = document.getElementById('peso').value;
                const altura = document.getElementById('altura').value;
                document.getElementById('sexo-error').classList.toggle('hidden', sexo !== '');
                document.getElementById('idade-error').classList.toggle('hidden', idade !== '' && idade >= 0 && idade <= 120);
                document.getElementById('peso-error').classList.toggle('hidden', peso !== '' && peso >= 0);
                document.getElementById('altura-error').classList.toggle('hidden', altura !== '' && altura >= 0);
                isValid = sexo !== '' && idade !== '' && peso !== '' && altura !== '';
            } else if (step === 2) {
                const sintomas = document.querySelectorAll('input[name="sintomas"]:checked').length;
                document.getElementById('sintomas-error').classList.toggle('hidden', sintomas > 0 && sintomas <= 5);
                isValid = sintomas > 0 && sintomas <= 5;
            } else if (step === 3) {
                const duracao = document.getElementById('duracao').value;
                const exposicao = document.getElementById('exposicao').value;
                document.getElementById('duracao-error').classList.toggle('hidden', duracao !== '');
                document.getElementById('exposicao-error').classList.toggle('hidden', exposicao !== '');
                isValid = duracao !== '' && exposicao !== '';
            } else if (step === 5) {
                const tabagismo = document.getElementById('tabagismo').value;
                const etilismo = document.getElementById('etilismo').value;
                const atividadeFisica = document.getElementById('atividade-fisica').value;
                document.getElementById('tabagismo-error').classList.toggle('hidden', tabagismo !== '');
                document.getElementById('etilismo-error').classList.toggle('hidden', etilismo !== '');
                document.getElementById('atividade-fisica-error').classList.toggle('hidden', atividadeFisica !== '');
                isValid = tabagismo !== '' && etilismo !== '' && atividadeFisica !== '';
            }
            return isValid;
        }

        // Salvar progresso do formulário
        function saveFormProgress() {
            const formData = {
                currentStep: currentStep,
                sexo: document.getElementById('sexo').value,
                idade: document.getElementById('idade').value,
                peso: document.getElementById('peso').value,
                altura: document.getElementById('altura').value,
                sintomas: Array.from(document.querySelectorAll('input[name="sintomas"]:checked')).map(input => input.value),
                sintomasSecundarios: Array.from(document.querySelectorAll('input[name="sintomas-secundarios"]:checked')).map(input => input.value),
                duracao: document.getElementById('duracao').value,
                exposicao: document.getElementById('exposicao').value,
                tabagismo: document.getElementById('tabagismo').value,
                etilismo: document.getElementById('etilismo').value,
                atividadeFisica: document.getElementById('atividade-fisica').value,
                estresse: document.getElementById('estresse').value,
                scannerResults: document.getElementById('scanner-feedback').innerText
            };
            localStorage.setItem('medicalIAFormProgress', JSON.stringify(formData));
        }

        // Carregar progresso salvo
        function loadFormProgress() {
            const savedData = localStorage.getItem('medicalIAFormProgress');
            if (savedData) {
                const formData = JSON.parse(savedData);
                
                // Restaurar valores dos campos
                document.getElementById('sexo').value = formData.sexo || '';
                document.getElementById('idade').value = formData.idade || '';
                document.getElementById('peso').value = formData.peso || '';
                document.getElementById('altura').value = formData.altura || '';
                document.getElementById('duracao').value = formData.duracao || '';
                document.getElementById('exposicao').value = formData.exposicao || '';
                document.getElementById('tabagismo').value = formData.tabagismo || '';
                document.getElementById('etilismo').value = formData.etilismo || '';
                document.getElementById('atividade-fisica').value = formData.atividadeFisica || '';
                document.getElementById('estresse').value = formData.estresse || '';
                
                // Restaurar checkboxes de sintomas
                formData.sintomas?.forEach(sintoma => {
                    const checkbox = document.querySelector(`input[name="sintomas"][value="${sintoma}"]`);
                    if (checkbox) checkbox.checked = true;
                });
                
                formData.sintomasSecundarios?.forEach(sintoma => {
                    const checkbox = document.querySelector(`input[name="sintomas-secundarios"][value="${sintoma}"]`);
                    if (checkbox) checkbox.checked = true;
                });
                
                // Restaurar resultados do scanner se existirem
                if (formData.scannerResults) {
                    document.getElementById('scanner-results').classList.remove('hidden');
                    document.getElementById('scanner-feedback').textContent = formData.scannerResults;
                }
                
                // Mostrar alerta de continuidade
                const continueAlert = document.createElement('div');
                continueAlert.className = 'bg-blue-900 text-blue-100 p-3 rounded mb-4';
                continueAlert.innerHTML = `
                    <p>Encontramos um questionário em progresso. Deseja continuar de onde parou?</p>
                    <div class="flex gap-2 mt-2">
                        <button id="continue-yes" class="futuristic-btn px-3 py-1 text-sm">Sim, continuar</button>
                        <button id="continue-no" class="bg-gray-700 hover:bg-gray-600 px-3 py-1 rounded text-sm">Não, começar novo</button>
                    </div>
                `;
                document.querySelector('.neon-box').prepend(continueAlert);
                
                document.getElementById('continue-yes').addEventListener('click', () => {
                    currentStep = formData.currentStep || 1;
                    document.querySelectorAll('.step').forEach(step => step.classList.remove('active'));
                    document.getElementById(`step-${currentStep}`).classList.add('active');
                    toggleSymptomDetails();
                    continueAlert.remove();
                });
                
                document.getElementById('continue-no').addEventListener('click', () => {
                    localStorage.removeItem('medicalIAFormProgress');
                    continueAlert.remove();
                });
            }
        }

        // Exibir campos adicionais para sintomas
        function toggleSymptomDetails() {
            const sintomas = Array.from(document.querySelectorAll('input[name="sintomas"]:checked')).map(input => input.value);
            document.getElementById('febre-details').classList.toggle('hidden', !sintomas.includes('Febre/Hipertermia'));
            document.getElementById('dor-details').classList.toggle('hidden', !sintomas.includes('Dor de Cabeça') && !sintomas.includes('Dor Muscular') && !sintomas.includes('Dor Abdominal'));
            document.getElementById('tosse-details').classList.toggle('hidden', !sintomas.includes('Tosse'));
            document.getElementById('dispneia-details').classList.toggle('hidden', !sintomas.includes('Dispneia'));
            document.getElementById('sintomas-outra').classList.toggle('hidden', !sintomas.includes('Outro'));
        }

        // Limitar seleção de sintomas
        document.querySelectorAll('input[name="sintomas"]').forEach(checkbox => {
            checkbox.addEventListener('change', () => {
                const checkedCount = document.querySelectorAll('input[name="sintomas"]:checked').length;
                if (checkedCount > 5) {
                    checkbox.checked = false;
                    document.getElementById('sintomas-error').classList.remove('hidden');
                    document.getElementById('sintomas-error').textContent = 'Selecione no máximo 5 sintomas.';
                } else {
                    document.getElementById('sintomas-error').classList.add('hidden');
                    toggleSymptomDetails();
                }
            });
        });

        // Scanner Corporal Avançado
        async function activateCameraScanner(type) {
            try {
                const scannerModal = document.createElement('div');
                scannerModal.className = 'fixed inset-0 bg-black bg-opacity-75 z-50 flex flex-col items-center justify-center';
                scannerModal.innerHTML = `
                    <div class="bg-gray-800 p-6 rounded-lg max-w-md w-full">
                        <h3 class="text-xl font-bold text-[#22d3ee] mb-4">Scanner de ${type === 'pele' ? 'Pele' : 'Voz'}</h3>
                        <div class="scanner-preview mb-4 ${type === 'pele' ? 'h-64 bg-gray-700' : ''}">
                            ${type === 'pele' ? 
                                '<video id="scanner-video" autoplay playsinline class="h-full w-full object-cover"></video>' : 
                                '<div id="audio-visualizer" class="h-32 bg-gray-700 flex items-center justify-center text-gray-400">Ondas sonoras aparecerão aqui</div>'}
                        </div>
                        <div class="scanner-controls flex justify-center gap-4">
                            <button id="capture-btn" class="futuristic-btn px-4 py-2">
                                ${type === 'pele' ? '<i class="fas fa-camera mr-2"></i> Capturar' : '<i class="fas fa-microphone mr-2"></i> Gravar'}
                            </button>
                            <button id="cancel-btn" class="bg-gray-700 hover:bg-gray-600 px-4 py-2 rounded">
                                Cancelar
                            </button>
                        </div>
                        <div id="scanner-processing" class="hidden mt-4 text-center">
                            <div class="animate-pulse text-[#22d3ee]">
                                <i class="fas fa-spinner fa-spin mr-2"></i> Analisando...
                            </div>
                        </div>
                    </div>
                `;
                document.body.appendChild(scannerModal);
                
                const stream = await navigator.mediaDevices.getUserMedia({ 
                    [type === 'pele' ? 'video' : 'audio']: true 
                });
                
                if (type === 'pele') {
                    const video = scannerModal.querySelector('#scanner-video');
                    video.srcObject = stream;
                } else {
                    // Configurar visualizador de áudio
                    setupAudioVisualizer(stream, scannerModal.querySelector('#audio-visualizer'));
                }
                
                scannerModal.querySelector('#cancel-btn').addEventListener('click', () => {
                    stream.getTracks().forEach(track => track.stop());
                    scannerModal.remove();
                });
                
                scannerModal.querySelector('#capture-btn').addEventListener('click', async () => {
                    scannerModal.querySelector('#scanner-processing').classList.remove('hidden');
                    
                    // Simular análise com IA
                    setTimeout(() => {
                        stream.getTracks().forEach(track => track.stop());
                        scannerModal.remove();
                        
                        document.getElementById('scanner-results').classList.remove('hidden');
                        const feedback = type === 'pele' ? 
                            'Análise de pele detectou: Eritema moderado (probabilidade 78%)' :
                            'Análise vocal: Padrão de estresse detectado (probabilidade 65%)';
                        
                        document.getElementById('scanner-feedback').innerHTML = `
                            <div class="p-4 bg-gray-700 rounded-lg">
                                <h5 class="font-semibold text-[#22d3ee] mb-2">Resultado do Scanner:</h5>
                                <p>${feedback}</p>
                                <div class="mt-2 text-sm text-gray-400">
                                    <i class="fas fa-info-circle mr-1"></i> Estes resultados são preliminares
                                </div>
                            </div>
                        `;
                    }, 2000);
                });
                
            } catch (error) {
                console.error('Erro no scanner:', error);
                document.getElementById('scanner-results').classList.remove('hidden');
                document.getElementById('scanner-feedback').innerHTML = `
                    <div class="p-4 bg-red-900 rounded-lg">
                        <p class="text-red-300">Erro: ${error.message}</p>
                        <p class="text-sm text-red-200 mt-1">Verifique as permissões do navegador e tente novamente</p>
                    </div>
                `;
            }
        }

        // Configurar visualizador de áudio
        function setupAudioVisualizer(stream, container) {
            const audioContext = new (window.AudioContext || window.webkitAudioContext)();
            const analyser = audioContext.createAnalyser();
            const microphone = audioContext.createMediaStreamSource(stream);
            microphone.connect(analyser);
            
            analyser.fftSize = 256;
            const bufferLength = analyser.frequencyBinCount;
            const dataArray = new Uint8Array(bufferLength);
            
            const canvas = document.createElement('canvas');
            canvas.width = container.offsetWidth;
            canvas.height = container.offsetHeight;
            container.innerHTML = '';
            container.appendChild(canvas);
            
            const canvasCtx = canvas.getContext('2d');
            
            function draw() {
                requestAnimationFrame(draw);
                analyser.getByteFrequencyData(dataArray);
                
                canvasCtx.fillStyle = 'rgb(31, 41, 55)';
                canvasCtx.fillRect(0, 0, canvas.width, canvas.height);
                
                const barWidth = (canvas.width / bufferLength) * 2.5;
                let x = 0;
                
                for (let i = 0; i < bufferLength; i++) {
                    const barHeight = dataArray[i] / 2;
                    canvasCtx.fillStyle = `rgb(${barHeight + 100}, 50, 50)`;
                    canvasCtx.fillRect(x, canvas.height - barHeight, barWidth, barHeight);
                    x += barWidth + 1;
                }
            }
            
            draw();
        }

        // Análise de Voz
        async function activateVoiceAnalysis() {
            try {
                const stream = await navigator.mediaDevices.getUserMedia({ audio: true });
                document.getElementById('scanner-results').classList.remove('hidden');
                document.getElementById('scanner-feedback').innerHTML = `
                    <div class="p-4 bg-gray-700 rounded-lg">
                        <h5 class="font-semibold text-[#22d3ee] mb-2">Análise de Voz</h5>
                        <p>Padrões vocais analisados: Frequência e intensidade normais</p>
                        <div class="mt-2 text-sm text-gray-400">
                            <i class="fas fa-info-circle mr-1"></i> Esta análise pode detectar sinais de estresse ou fadiga vocal
                        </div>
                    </div>
                `;
                stream.getTracks().forEach(track => track.stop());
            } catch (error) {
                document.getElementById('scanner-results').classList.remove('hidden');
                document.getElementById('scanner-feedback').innerHTML = `
                    <div class="p-4 bg-red-900 rounded-lg">
                        <p class="text-red-300">Erro: ${error.message}</p>
                        <p class="text-sm text-red-200 mt-1">Verifique as permissões do microfone e tente novamente</p>
                    </div>
                `;
            }
        }

        // Diagnóstico Avançado
        async function enhancedDiagnosis(userData) {
            // Obter dados biométricos de wearables (simulado)
            const biometricData = await fetchBiometricData();
            
            // Análise emocional integrada
            const emotionalAnalysis = await analyzeEmotionalPatterns(userData);
            
            // Análise de imagem/voz se disponível
            const visualAnalysis = userData.scannerResults ? 
                await analyzeVisualData(userData.scannerResults) : null;
            
            // Cálculo de scores multidimensionais
            const healthScores = calculateHealthScores(userData, biometricData, emotionalAnalysis, visualAnalysis);
            
            // Diagnóstico diferencial com IA
            const diagnoses = await fetchAIDiagnosis({
                symptoms: userData.symptoms,
                history: userData.history,
                biometrics: biometricData,
                emotional: emotionalAnalysis,
                visual: visualAnalysis,
                lifestyle: userData.lifestyle
            });
            
            // Recomendações personalizadas
            const recommendations = generatePersonalizedRecommendations(
                diagnoses.primary, 
                healthScores,
                userData.lifestyle,
                userData.history
            );
            
            // Plano de monitoramento
            const monitoringPlan = createMonitoringPlan(
                diagnoses.primary, 
                healthScores,
                userData.lifestyle
            );
            
            return {
                healthScores,
                primaryDiagnosis: diagnoses.primary,
                differentialDiagnoses: diagnoses.differential,
                recommendations,
                monitoringPlan,
                biometricData
            };
        }

        // Obter dados biométricos (simulado/integrado com wearables)
        async function fetchBiometricData() {
            // Tentar obter dados reais de APIs de saúde se disponíveis
            try {
                if (navigator.bluetooth) {
                    const device = await navigator.bluetooth.requestDevice({
                        acceptAllDevices: true,
                        optionalServices: ['heart_rate', 'blood_pressure']
                    });
                    const server = await device.gatt.connect();
                    // Obter dados de serviços de saúde...
                    return {
                        heartRate: 72,
                        bloodPressure: '120/80',
                        oxygenLevel: 98,
                        lastUpdate: new Date()
                    };
                }
            } catch (error) {
                console.log('Usando dados simulados:', error);
            }
            
            // Dados simulados se a API não estiver disponível
            return {
                heartRate: Math.floor(Math.random() * 30) + 60,
                bloodPressure: `${Math.floor(Math.random() * 20) + 110}/${Math.floor(Math.random() * 10) + 70}`,
                oxygenLevel: Math.floor(Math.random() * 5) + 95,
                lastUpdate: new Date()
            };
        }

        // Analisar padrões emocionais
        async function analyzeEmotionalPatterns(userData) {
            const emotionalScore = userData.stressLevel || 
                                 (userData.symptoms.includes('Fadiga') ? 70 : 
                                 (userData.symptoms.includes('Dor de Cabeça') ? 65 : 50));
            
            // Detectar padrões específicos
            const patterns = [];
            if (userData.symptoms.includes('Tristeza Persistente')) patterns.push('depressão');
            if (userData.symptoms.includes('Confusão Mental')) patterns.push('ansiedade');
            if (userData.symptoms.includes('Tontura') && emotionalScore > 60) patterns.push('estresse');
            
            return { 
                score: emotionalScore, 
                patterns,
                description: patterns.length > 0 ? 
                    `Padrões detectados: ${patterns.join(', ')}` : 
                    'Nenhum padrão emocional significativo detectado'
            };
        }

        // Analisar dados visuais (simulado)
        async function analyzeVisualData(scannerResults) {
            // Simular análise de IA
            await new Promise(resolve => setTimeout(resolve, 500));
            
            // Extrair informações do texto de resultados (simulação)
            const hasSkinIssues = scannerResults.includes('Eritema') || scannerResults.includes('manchas');
            const hasVoiceStress = scannerResults.includes('estresse') || scannerResults.includes('fadiga');
            
            return {
                skin: hasSkinIssues ? 'Possíveis anomalias detectadas' : 'Normal',
                voice: hasVoiceStress ? 'Padrão de estresse vocal' : 'Normal',
                skinIssues: hasSkinIssues,
                voiceStress: hasVoiceStress
            };
        }

        // Calcular scores de saúde multidimensionais
        function calculateHealthScores(userData, biometricData, emotionalAnalysis, visualAnalysis) {
            // Física (0-100)
            const physicalScore = Math.max(0, 85 - 
                (userData.symptoms.length * 2) - 
                (biometricData.heartRate > 100 ? 5 : 0) -
                (visualAnalysis?.skinIssues ? 10 : 0)
            );
            
            // Emocional (0-100)
            const emotionalScore = Math.max(0, 100 - 
                (emotionalAnalysis.score * 5) - 
                (userData.symptoms.includes('Fadiga') ? 15 : 0) -
                (userData.symptoms.includes('Tristeza Persistente') ? 20 : 0)
            );
            
            // Metabólica (0-100)
            const metabolicScore = Math.max(0, 90 - 
                (userData.history.includes('Diabetes') ? 15 : 0) -
                (userData.history.includes('Hipertensão') ? 10 : 0) -
                (userData.lifestyle.tabagismo === 'Fumante Ativo' ? 10 : 0)
            );
            
            // Ambiental (0-100)
            const environmentalScore = Math.max(0, 95 - 
                (userData.exposicao !== 'Nenhuma' ? 20 : 0) -
                (userData.lifestyle.atividadeFisica === 'Sedentário' ? 10 : 0)
            );
            
            return {
                physical: Math.round(physicalScore),
                emotional: Math.round(emotionalScore),
                metabolic: Math.round(metabolicScore),
                environmental: Math.round(environmentalScore)
            };
        }

        // Obter diagnóstico com IA (simulado)
        async function fetchAIDiagnosis(data) {
            const physicalConditions = {
                'Gripe': { 
                    symptoms: ['Febre/Hipertermia', 'Tosse', 'Fadiga', 'Dor Muscular'], 
                    probability: 80,
                    riskFactors: ['Contato com Doentes', 'Viagem Internacional']
                },
                'Dengue': { 
                    symptoms: ['Febre/Hipertermia', 'Dor Muscular', 'Manchas Cutâneas'], 
                    probability: 85,
                    riskFactors: ['Área com Surtos', 'Animais ou Insetos']
                },
                'Gastrite': { 
                    symptoms: ['Náusea/Vômito', 'Dor Abdominal'], 
                    probability: 70,
                    riskFactors: ['Estresse elevado']
                },
                'Infecção Urinária': {
                    symptoms: ['Dor Abdominal', 'Febre/Hipertermia'],
                    probability: 65,
                    riskFactors: []
                }
            };
            
            const emotionalConditions = {
                'Síndrome do Pânico': { 
                    symptoms: ['Dispneia', 'Tontura', 'Tristeza Persistente'], 
                    emotionalThreshold: 80,
                    probability: 75
                },
                'Burnout': { 
                    symptoms: ['Fadiga', 'Dor de Cabeça', 'Confusão Mental'], 
                    emotionalThreshold: 75,
                    probability: 70
                },
                'Transtorno de Ansiedade': { 
                    symptoms: ['Tristeza Persistente', 'Dor Muscular', 'Tontura'], 
                    emotionalThreshold: 70,
                    probability: 65
                }
            };

            let primary = [], differential = [];
            
            // Diagnósticos físicos
            for (const [condition, info] of Object.entries(physicalConditions)) {
                const symptomMatch = info.symptoms.filter(s => data.symptoms.includes(s)).length;
                const riskMatch = info.riskFactors.filter(r => data.exposicao === r).length;
                
                if (symptomMatch > 0) {
                    const probability = Math.min(95, info.probability + (symptomMatch * 5) + (riskMatch * 10));
                    primary.push({ 
                        condition, 
                        probability,
                        type: 'physical'
                    });
                } else {
                    differential.push({ 
                        condition, 
                        probability: info.probability * 0.5,
                        type: 'physical'
                    });
                }
            }
            
            // Diagnósticos emocionais
            for (const [condition, info] of Object.entries(emotionalConditions)) {
                const symptomMatch = info.symptoms.filter(s => data.symptoms.includes(s)).length;
                
                if (data.emotional.score >= info.emotionalThreshold && symptomMatch > 0) {
                    const probability = Math.min(95, info.probability + (symptomMatch * 5) + (data.emotional.score - 70));
                    primary.push({ 
                        condition, 
                        probability,
                        type: 'emotional'
                    });
                } else if (symptomMatch > 0) {
                    differential.push({ 
                        condition, 
                        probability: info.probability * 0.5,
                        type: 'emotional'
                    });
                }
            }
            
            // Ordenar por probabilidade
            primary.sort((a, b) => b.probability - a.probabilitypara fetchAIDiagnosis
primary.sort((a, b) => b.probability - a.probability);
differential.sort((a, b) => b.probability - a.probability);

// Selecionar o diagnóstico primário
const primaryDiagnosis = primary.length > 0 ? primary[0] : {
condition: "Nenhum diagnóstico específico identificado",
probability: 0,
type: "general"
};

return {
primary: primaryDiagnosis,
differential: differential.slice(0, 3) // Limitar a 3 diagnósticos diferenciais
};
}

// Gerar recomendações personalizadas
function generatePersonalizedRecommendations(primaryDiagnosis, healthScores, lifestyle, history) {
const recommendations = {
medical: [],
lifestyle: [],
monitoring: []
};

// Recomendações baseadas no diagnóstico primário
switch (primaryDiagnosis.condition) {
case "Gripe":
recommendations.medical.push("Consultar médico para avaliação de antiviral", "Hidratação oral intensiva");
recommendations.lifestyle.push("Repouso por 5-7 dias", "Evitar contato com outras pessoas");
recommendations.monitoring.push("Medir temperatura corporal a cada 6 horas", "Acompanhar sintomas respiratórios");
break;
case "Dengue":
recommendations.medical.push("Consultar médico para exames laboratoriais", "Reposição de fluidos");
recommendations.lifestyle.push("Evitar picadas de mosquitos (usar repelente)", "Repouso absoluto");
recommendations.monitoring.push("Monitorar febre e sinais de sangramento", "Acompanhar hidratação");
break;
case "Gastrite":
recommendations.medical.push("Consultar gastroenterologista", "Considerar inibidores de bomba de prótons");
recommendations.lifestyle.push("Evitar alimentos gordurosos e ácidos", "Praticar refeições leves e frequentes");
recommendations.monitoring.push("Registrar episódios de dor abdominal", "Monitorar resposta a mudanças na dieta");
break;
case "Infecção Urinária":
recommendations.medical.push("Consultar médico para antibióticos", "Realizar exame de urina");
recommendations.lifestyle.push("Aumentar ingestão de água", "Evitar segurar urina por longos períodos");
recommendations.monitoring.push("Acompanhar frequência urinária", "Monitorar sintomas de febre");
break;
case "Síndrome do Pânico":
case "Burnout":
case "Transtorno de Ansiedade":
recommendations.medical.push("Consultar psiquiatra ou psicólogo", "Avaliar necessidade de terapia medicamentosa");
recommendations.lifestyle.push("Praticar técnicas de relaxamento (ex.: respiração profunda)", "Estabelecer rotina de sono regular");
recommendations.monitoring.push("Registrar episódios de ansiedade", "Acompanhar níveis de estresse");
break;
default:
recommendations.medical.push("Consultar médico para avaliação detalhada");
recommendations.lifestyle.push("Adotar dieta equilibrada", "Manter atividade física regular");
recommendations.monitoring.push("Realizar check-up anual", "Monitorar sinais vitais regularmente");
}

// Ajustes baseados em scores de saúde
if (healthScores.physical < 60) {
recommendations.medical.push("Priorizar consulta médica urgente");
}
if (healthScores.emotional < 50) {
recommendations.lifestyle.push("Considerar práticas de mindfulness");
recommendations.monitoring.push("Registrar humor diário");
}
if (healthScores.metabolic < 60) {
recommendations.lifestyle.push("Reduzir consumo de açúcares e gorduras");
recommendations.monitoring.push("Monitorar glicemia e pressão arterial");
}
if (healthScores.environmental < 60) {
recommendations.lifestyle.push("Evitar exposição a ambientes de risco");
}

// Ajustes baseados no estilo de vida
if (lifestyle.tabagismo === "Fumante Ativo") {
recommendations.lifestyle.push("Iniciar programa de cessação de tabagismo");
recommendations.monitoring.push("Acompanhar função pulmonar");
}
if (lifestyle.etilismo === "Uso Regular") {
recommendations.lifestyle.push("Reduzir consumo de álcool");
}
if (lifestyle.atividadeFisica === "Sedentário") {
recommendations.lifestyle.push("Iniciar atividade física leve (ex.: caminhada 30 min/dia)");
}

// Ajustes baseados no histórico
if (history.includes("Diabetes")) {
recommendations.monitoring.push("Monitorar glicemia regularmente");
}
if (history.includes("Hipertensão")) {
recommendations.monitoring.push("Medir pressão arterial diariamente");
}

return recommendations;
}

// Criar plano de monitoramento
function createMonitoringPlan(primaryDiagnosis, healthScores, lifestyle) {
const plan = [];

// Baseado no diagnóstico primário
switch (primaryDiagnosis.condition) {
case "Gripe":
case "Dengue":
plan.push("Acompanhar febre e sintomas por 7 dias", "Registrar sinais vitais 2x/dia");
break;
case "Gastrite":
plan.push("Monitorar episódios de dor abdominal", "Anotar alimentos desencadeantes");
break;
case "Infecção Urinária":
plan.push("Monitorar sintomas urinários", "Acompanhar ingestão de líquidos");
break;
case "Síndrome do Pânico":
case "Burnout":
case "Transtorno de Ansiedade":
plan.push("Registrar episódios de ansiedade diária", "Monitorar qualidade do sono");
break;
default:
plan.push("Realizar check-up anual", "Monitorar sinais vitais semanalmente");
}

// Ajustes baseados em scores
if (healthScores.emotional < 50) {
plan.push("Manter diário emocional por 2 semanas");
}
if (healthScores.metabolic < 60) {
plan.push("Acompanhar peso e IMC mensalmente");
}

// Ajustes baseados no estilo de vida
if (lifestyle.tabagismo === "Fumante Ativo") {
plan.push("Monitorar tentativas de redução do tabagismo");
}
if (lifestyle.atividadeFisica === "Sedentário") {
plan.push("Registrar minutos de atividade física semanal");
}

return plan;
}

// Processar Diagnóstico
async function processarDiagnostico() {
if (!validateStep(currentStep)) return;

const userData = {
symptoms: Array.from(document.querySelectorAll('input[name="sintomas"]:checked')).map(input => input.value)
.concat(Array.from(document.querySelectorAll('input[name="sintomas-secundarios"]:checked')).map(input => input.value)),
history: Array.from(document.querySelectorAll('input[name="cronicas"]:checked')).map(input => input.value),
lifestyle: {
tabagismo: document.getElementById('tabagismo').value,
etilismo: document.getElementById('etilismo').value,
atividadeFisica: document.getElementById('atividade-fisica').value,
stressLevel: parseInt(document.getElementById('estresse').value) || 0
},
exposicao: document.getElementById('exposicao').value,
scannerResults: document.getElementById('scanner-feedback').innerText,
peso: parseFloat(document.getElementById('peso').value),
altura: parseFloat(document.getElementById('altura').value)
};

// Obter diagnóstico avançado
const diagnosisResult = await enhancedDiagnosis(userData);

// Exibir painel de saúde
document.getElementById('diagnostico-form').classList.add('hidden');
document.getElementById('holistic-dashboard').classList.remove('hidden');

// Atualizar scores
const overallScore = Math.round(
(diagnosisResult.healthScores.physical +
diagnosisResult.healthScores.emotional +
diagnosisResult.healthScores.metabolic +
diagnosisResult.healthScores.environmental) / 4
);
document.getElementById('overall-health-score').textContent = overallScore;
document.getElementById('health-status').textContent = overallScore > 80 ? "Ótima saúde" :
overallScore > 60 ? "Saúde moderada" :
"Necessita atenção";

document.getElementById('physical-score').textContent = diagnosisResult.healthScores.physical;
document.getElementById('emotional-score').textContent = diagnosisResult.healthScores.emotional;
document.getElementById('metabolic-score').textContent = diagnosisResult.healthScores.metabolic;
document.getElementById('environmental-score').textContent = diagnosisResult.healthScores.environmental;

// Atualizar diagnóstico
document.getElementById('primary-diagnosis').textContent = diagnosisResult.primaryDiagnosis.condition;
document.getElementById('diagnosis-confidence').textContent = Confiança: ${diagnosisResult.primaryDiagnosis.probability}%;

// Atualizar recomendações
document.getElementById('medical-actions').innerHTML = diagnosisResult.recommendations.medical
.map(item => <li>${item}</li>).join('');
document.getElementById('lifestyle-actions').innerHTML = diagnosisResult.recommendations.lifestyle
.map(item => <li>${item}</li>).join('');
document.getElementById('monitoring-actions').innerHTML = diagnosisResult.recommendations.monitoring
.map(item => <li>${item}</li>).join('');

// Gerar gráficos
generateHealthCharts(diagnosisResult.healthScores);

// Limpar progresso salvo
localStorage.removeItem('medicalIAFormProgress');
}

// Gerar gráficos de saúde
function generateHealthCharts(scores) {
const chartConfig = {
type: 'radar',
data: {
labels: ['Física', 'Emocional', 'Metabólica', 'Ambiental'],
datasets: [{
label: 'Score de Saúde',
data: [
scores.physical,
scores.emotional,
scores.metabolic,
scores.environmental
],
backgroundColor: 'rgba(34, 211, 238, 0.2)',
borderColor: '#22d3ee',
pointBackgroundColor: '#22d3ee',
borderWidth: 2
}]
},
options: {
responsive: true,
scales: {
r: {
min: 0,
max: 100,
ticks: { stepSize: 20, color: '#e5e7eb' },
grid: { color: 'rgba(255, 255, 255, 0.1)' },
pointLabels: { color: '#e5e7eb' }
}
},
plugins: {
legend: { display: false }
}
}
};

// Gerar gráficos individuais
['physical', 'emotional', 'metabolic', 'environmental'].forEach(dimension => {
const canvas = document.getElementById(${dimension}-chart);
new Chart(canvas, { ...chartConfig, data: { ...chartConfig.data, datasets: [{ ...chartConfig.data.datasets[0], data: [scores[dimension], 0, 0, 0] }] } });
});

// Gerar linha do tempo de saúde
const timelineChart = new Chart(document.getElementById('health-timeline-chart'), {
type: 'line',
data: {
labels: ['Dia 1', 'Dia 2', 'Dia 3', 'Dia 4', 'Dia 5'],
datasets: [{
label: 'Score Geral',
data: [overallScore - 10, overallScore - 5, overallScore, overallScore + 5, overallScore + 10].map(score => Math.min(100, Math.max(0, score))),
borderColor: '#22d3ee',
backgroundColor: 'rgba(34, 211, 238, 0.2)',
fill: true,
tension: 0.4
}]
},
options: {
responsive: true,
scales: {
y: { min: 0, max: 100, ticks: { color: '#e5e7eb' }, grid: { color: 'rgba(255, 255, 255, 0.1)' } },
x: { ticks: { color: '#e5e7eb' }, grid: { color: 'rgba(255, 255, 255, 0.1)' } }
},
plugins: {
legend: { display: false }
}
}
});
}

// Exportar relatório
document.getElementById('export-report').addEventListener('click', async () => {
const { jsPDF } = window.jspdf;
const dashboard = document.getElementById('holistic-dashboard');
const canvas = await html2canvas(dashboard, { backgroundColor: '#1F2937', scale: 2 });
const imgData = canvas.toDataURL('image/png');
const pdf = new jsPDF('p', 'mm', 'a4');
const pdfWidth = pdf.internal.pageSize.getWidth();
const pdfHeight = (canvas.height * pdfWidth) / canvas.width;
pdf.addImage(imgData, 'PNG', 0, 0, pdfWidth, pdfHeight);
pdf.setProperties({
title: Relatório de Saúde - ${new Date().toLocaleDateString()},
subject: 'Diagnóstico gerado pelo Medical IA',
author: 'Álibis Digital'
});
pdf.save(relatorio-saude-${new Date().toLocaleDateString()}.pdf);
});

// Acessibilidade
function enhanceAccessibility() {
// Navegação por teclado
const focusableElements = document.querySelectorAll('button, input, select, textarea, [tabindex]:not([tabindex="-1"])');
focusableElements.forEach((el, index) => {
el.addEventListener('keydown', (e) => {
if (e.key === 'Enter' || e.key === ' ') {
e.preventDefault();
el.click();
}
if (e.key === 'Tab') {
e.preventDefault();
const nextIndex = e.shiftKey ? index - 1 : index + 1;
const nextEl = focusableElements[nextIndex < 0 ? focusableElements.length - 1 : nextIndex % focusableElements.length];
nextEl.focus();
}
});
});

// Alternar modo de alto contraste
const contrastToggle = document.createElement('button');
contrastToggle.className = 'fixed bottom-4 right-4 bg-gray-800 p-2 rounded-full text-white';
contrastToggle.innerHTML = '';
contrastToggle.title = 'Alternar modo de alto contraste';
contrastToggle.addEventListener('click', () => {
document.body.classList.toggle('high-contrast');
});
document.body.appendChild(contrastToggle);
}

// Inicialização
document.addEventListener('DOMContentLoaded', () => {
enhanceAccessibility();
loadFormProgress();
document.querySelectorAll('input[name="sintomas"], input[name="sintomas-secundarios"]').forEach(checkbox => {
checkbox.addEventListener('change', toggleSymptomDetails);
});

// Configurar inputs dinâmicos
document.getElementById('tabagismo').addEventListener('change', () => {
document.getElementById('tabagismo-detalhes').classList.toggle('hidden', document.getElementById('tabagismo').value !== 'Fumante Ativo');
});
document.getElementById('etilismo').addEventListener('change', () => {
document.getElementById('etilismo-detalhes').classList.toggle('hidden', document.getElementById('etilismo').value !== 'Uso Regular');
});
document.getElementById('sintoma-outro').addEventListener('change', () => {
document.getElementById('sintomas-outra').classList.toggle('hidden', !document.getElementById('sintoma-outro').checked);
});
document.querySelector('input[name="cronicas"][value="Outra"]').addEventListener('change', () => {
document.getElementById('cronicas-outra').classList.toggle('hidden', !document.querySelector('input[name="cronicas"][value="Outra"]').checked);
});
});
</script>

Medical IA
Sua plataforma avançada de diagnóstico médico com IA.

Links Rápidos
Blog
Criar Álibi
Scanner com IA
Apoio Emocional
Suporte
Contato
suporte@medicalia.com

(11) 91234-5678

© 2025 Álibis Digital. Todos os direitos reservados.
